import{s as z,a5 as Ye,x as oe,a6 as Nt,a7 as se,B as ue,a as n,F as ae,m as U,a8 as xe,A as D,i as I,a9 as Xe,aa as ka,ab as lt,ac as Re,ad as Ca,ae as Gt,af as Aa,ag as fe,ah as Ta,ai as rt,aj as Ia,ak as ve,al as Be,am as zt,v as ut,an as Da,ao as Ue,y as ge,ap as Ke,aq as _e,ar as ke,as as ct,b as T,at as Pt,u as S,au as Kt,av as $a,aw as qt,ax as Wt,ay as Oa,az as Ea,aA as Ae,K as H,aB as Yt,aC as Ra,aD as Ba,aE as Te,aF as La,aG as Ma,aH as Fa,aI as Ua,aJ as Xt,aK as Ha,aL as ja,z as Na,C as Ga,aM as za,aN as Ka,aO as qa,aP as Wa,aQ as Ya,aR as Xa,aS as Qa,aT as Ja,aU as Za,L as Qt,M as el,T as Vt,N as xt,P as kt,O as Ct,aV as nt,aW as tl,aX as At,Z as al,aY as Tt,Y as ll,aZ as It,a0 as nl,a_ as sl,a1 as ol,U as Dt,a$ as il,b0 as Ne,d as ce,o as R,c as j,w as v,g as x,h as Le,e as te,f as Qe,t as X,J as Oe,b1 as rl,b2 as ul,I as st,n as qe,p as dt,q as mt,b3 as cl,b4 as dl,E as Pe,H as Jt,b5 as ml,b6 as vt,b7 as vl,b8 as fl,b9 as pl,ba as Zt,bb as gl,bc as ot,bd as Ge,be as yl,bf as hl,bg as bl,bh as _l,bi as Sl,bj as wl,bk as Pl,bl as Vl,bm as xl,bn as kl,bo as Cl,_ as Al,bp as Tl,bq as Il}from"./index-fa2d734a.js";import{b as Dl,u as ft}from"./ConfigurationStore-7b23a5a4.js";import{a as be,V as me}from"./VRow-781382bd.js";import{V as pt,a as $e}from"./VTextarea-3eec484e.js";import{V as ee}from"./VTooltip-b5f40b4d.js";import{c as $l,b as Me,V as Je,a as it}from"./VForm-442b891f.js";import{a as ie,b as re,V as Ce,c as ea,d as Ol}from"./VCard-4d112d66.js";import{m as El,u as Rl,V as Ee}from"./VList-6f91db5c.js";import{g as Bl,m as Ll,u as Ml,a as ta,b as aa,V as We}from"./VOverlay-a17eb942.js";import{f as gt}from"./forwardRefs-e2994a01.js";import{V as la,a as yt}from"./VMenu-46c570ce.js";import{V as pe}from"./VListItem-99841f34.js";import{V as Fe}from"./VAlert-57bda60a.js";import{a as Fl,b as Ul,c as na,m as Hl,d as jl,V as $t,e as Nl,f as Gl}from"./VField-f756959d.js";import{V as zl}from"./VChip-d9d67e94.js";import{_ as Ze}from"./_plugin-vue_export-helper-c27b6911.js";import{V as ht}from"./VDivider-7dfa9365.js";import{m as Kl,V as Ot}from"./VTable-b3c64698.js";import"./delay-fab8d36b.js";const ql=z({renderless:Boolean,...Ye()},"VVirtualScrollItem"),Wl=oe()({name:"VVirtualScrollItem",inheritAttrs:!1,props:ql(),emits:{"update:height":e=>!0},setup(e,t){let{attrs:a,emit:l,slots:o}=t;const{resizeRef:i,contentRect:s}=Nt(void 0,"border");se(()=>{var u;return(u=s.value)==null?void 0:u.height},u=>{u!=null&&l("update:height",u)}),ue(()=>{var u,d;return e.renderless?n(ae,null,[(u=o.default)==null?void 0:u.call(o,{itemRef:i})]):n("div",U({ref:i,class:["v-virtual-scroll__item",e.class],style:e.style},a),[(d=o.default)==null?void 0:d.call(o)])})}}),Et=-1,Rt=1,Yl=z({itemHeight:{type:[Number,String],default:48}},"virtual");function Xl(e,t,a){const l=xe(0),o=xe(e.itemHeight),i=D({get:()=>parseInt(o.value??0,10),set(_){o.value=_}}),s=I(),{resizeRef:u,contentRect:d}=Nt();Xe(()=>{u.value=s.value});const f=ka(),m=new Map;let r=Array.from({length:t.value.length});const c=D(()=>{const _=(!d.value||s.value===document.documentElement?f.height.value:d.value.height)-((a==null?void 0:a.value)??0);return Math.ceil(_/i.value*1.7+1)});function p(_,k){i.value=Math.max(i.value,k),r[_]=k,m.set(t.value[_],k)}function g(_){return r.slice(0,_).reduce((k,w)=>k+(w||i.value),0)}function P(_){const k=t.value.length;let w=0,M=0;for(;M<_&&w<k;)M+=r[w++]||i.value;return w-1}let y=0;function V(){if(!s.value||!d.value)return;const _=d.value.height-56,k=s.value.scrollTop,w=k<y?Et:Rt,M=P(k+_/2),N=Math.round(c.value/3),O=M-N,G=l.value+N*2-1;w===Et&&M<=G?l.value=Re(O,0,t.value.length):w===Rt&&M>=G&&(l.value=Re(O,0,t.value.length-c.value)),y=k}function $(_){if(!s.value)return;const k=g(_);s.value.scrollTop=k}const A=D(()=>Math.min(t.value.length,l.value+c.value)),b=D(()=>t.value.slice(l.value,A.value).map((_,k)=>({raw:_,index:k+l.value}))),h=D(()=>g(l.value)),E=D(()=>g(t.value.length)-g(A.value));return se(()=>t.value.length,()=>{r=lt(t.value.length).map(()=>i.value),m.forEach((_,k)=>{const w=t.value.indexOf(k);w===-1?m.delete(k):r[w]=_})}),{containerRef:s,computedItems:b,itemHeight:i,paddingTop:h,paddingBottom:E,scrollToIndex:$,handleScroll:V,handleItemResize:p}}const Ql=z({items:{type:Array,default:()=>[]},renderless:Boolean,...Yl(),...Ye(),...Ca()},"VVirtualScroll"),Jl=oe()({name:"VVirtualScroll",props:Ql(),setup(e,t){let{slots:a}=t;const l=Gt("VVirtualScroll"),{dimensionStyles:o}=Aa(e),{containerRef:i,handleScroll:s,handleItemResize:u,scrollToIndex:d,paddingTop:f,paddingBottom:m,computedItems:r}=Xl(e,fe(e,"items"));return Ta(()=>e.renderless,()=>{rt(()=>{var c;i.value=Bl(l.vnode.el,!0),(c=i.value)==null||c.addEventListener("scroll",s)}),Ia(()=>{var c;(c=i.value)==null||c.removeEventListener("scroll",s)})}),ue(()=>{const c=r.value.map(p=>n(Wl,{key:p.index,renderless:e.renderless,"onUpdate:height":g=>u(p.index,g)},{default:g=>{var P;return(P=a.default)==null?void 0:P.call(a,{item:p.raw,index:p.index,...g})}}));return e.renderless?n(ae,null,[n("div",{class:"v-virtual-scroll__spacer",style:{paddingTop:ve(f.value)}},null),c,n("div",{class:"v-virtual-scroll__spacer",style:{paddingBottom:ve(m.value)}},null)]):n("div",{ref:i,class:["v-virtual-scroll",e.class],onScroll:s,style:[o.value,e.style]},[n("div",{class:"v-virtual-scroll__container",style:{paddingTop:ve(f.value),paddingBottom:ve(m.value)}},[c])])}),{scrollToIndex:d}}});function Zl(e,t){const a=xe(!1);let l;function o(u){cancelAnimationFrame(l),a.value=!0,l=requestAnimationFrame(()=>{l=requestAnimationFrame(()=>{a.value=!1})})}async function i(){await new Promise(u=>requestAnimationFrame(u)),await new Promise(u=>requestAnimationFrame(u)),await new Promise(u=>requestAnimationFrame(u)),await new Promise(u=>{if(a.value){const d=se(a,()=>{d(),u()})}else u()})}async function s(u){var m,r;if(u.key==="Tab"&&((m=t.value)==null||m.focus()),!["PageDown","PageUp","Home","End"].includes(u.key))return;const d=(r=e.value)==null?void 0:r.$el;if(!d)return;(u.key==="Home"||u.key==="End")&&d.scrollTo({top:u.key==="Home"?0:d.scrollHeight,behavior:"smooth"}),await i();const f=d.querySelectorAll(":scope > :not(.v-virtual-scroll__spacer)");if(u.key==="PageDown"||u.key==="Home"){const c=d.getBoundingClientRect().top;for(const p of f)if(p.getBoundingClientRect().top>=c){p.focus();break}}else{const c=d.getBoundingClientRect().bottom;for(const p of[...f].reverse())if(p.getBoundingClientRect().bottom<=c){p.focus();break}}}return{onListScroll:o,onListKeydown:s}}const en=z({chips:Boolean,closableChips:Boolean,closeText:{type:String,default:"$vuetify.close"},openText:{type:String,default:"$vuetify.open"},eager:Boolean,hideNoData:Boolean,hideSelected:Boolean,menu:Boolean,menuIcon:{type:Be,default:"$dropdown"},menuProps:{type:Object},multiple:Boolean,noDataText:{type:String,default:"$vuetify.noDataText"},openOnClear:Boolean,valueComparator:{type:Function,default:zt},itemColor:String,...El({itemChildren:!1})},"Select"),tn=z({...en(),...ut($l({modelValue:null,role:"button"}),["validationValue","dirty","appendInnerIcon"]),...Da({transition:{component:la}})},"VSelect"),sa=oe()({name:"VSelect",props:tn(),emits:{"update:focused":e=>!0,"update:modelValue":e=>!0,"update:menu":e=>!0},setup(e,t){let{slots:a}=t;const{t:l}=Ue(),o=I(),i=I(),s=ge(e,"menu"),u=D({get:()=>s.value,set:C=>{var B;s.value&&!C&&((B=i.value)!=null&&B.Î¨openChildren)||(s.value=C)}}),{items:d,transformIn:f,transformOut:m}=Rl(e),r=ge(e,"modelValue",[],C=>f(C===null?[null]:Ke(C)),C=>{const B=m(C);return e.multiple?B:B[0]??null}),c=Fl(),p=D(()=>r.value.map(C=>d.value.find(B=>{const q=_e(B.raw,e.itemValue),Y=_e(C.raw,e.itemValue);return q===void 0||Y===void 0?!1:e.returnObject?e.valueComparator(q,Y):e.valueComparator(B.value,C.value)})||C)),g=D(()=>p.value.map(C=>C.props.value)),P=xe(!1),y=D(()=>u.value?e.closeText:e.openText);let V="",$;const A=D(()=>e.hideSelected?d.value.filter(C=>!p.value.some(B=>B===C)):d.value),b=D(()=>e.hideNoData&&!d.value.length||e.readonly||(c==null?void 0:c.isReadonly.value)),h=I(),{onListScroll:E,onListKeydown:_}=Zl(h,o);function k(C){e.openOnClear&&(u.value=!0)}function w(){b.value||(u.value=!u.value)}function M(C){var L,F;if(!C.key||e.readonly||c!=null&&c.isReadonly.value)return;["Enter"," ","ArrowDown","ArrowUp","Home","End"].includes(C.key)&&C.preventDefault(),["Enter","ArrowDown"," "].includes(C.key)&&(u.value=!0),["Escape","Tab"].includes(C.key)&&(u.value=!1),C.key==="Home"?(L=h.value)==null||L.focus("first"):C.key==="End"&&((F=h.value)==null||F.focus("last"));const B=1e3;function q(K){const de=K.key.length===1,ne=!K.ctrlKey&&!K.metaKey&&!K.altKey;return de&&ne}if(e.multiple||!q(C))return;const Y=performance.now();Y-$>B&&(V=""),V+=C.key.toLowerCase(),$=Y;const J=d.value.find(K=>K.title.toLowerCase().startsWith(V));J!==void 0&&(r.value=[J])}function N(C){if(e.multiple){const B=g.value.findIndex(q=>e.valueComparator(q,C.value));if(B===-1)r.value=[...r.value,C];else{const q=[...r.value];q.splice(B,1),r.value=q}}else r.value=[C],u.value=!1}function O(C){var B;(B=h.value)!=null&&B.$el.contains(C.relatedTarget)||(u.value=!1)}function G(){var C;P.value&&((C=o.value)==null||C.focus())}function W(C){P.value=!0}function le(C){if(C==null)r.value=[];else if(Pt(o.value,":autofill")||Pt(o.value,":-webkit-autofill")){const B=d.value.find(q=>q.title===C);B&&N(B)}else o.value&&(o.value.value="")}return ue(()=>{const C=!!(e.chips||a.chip),B=!!(!e.hideNoData||A.value.length||a["prepend-item"]||a["append-item"]||a["no-data"]),q=r.value.length>0,[Y]=Me.filterProps(e),J=q||!P.value&&e.label&&!e.persistentPlaceholder?void 0:e.placeholder;return n(Me,U({ref:o},Y,{modelValue:r.value.map(L=>L.props.value).join(", "),"onUpdate:modelValue":le,focused:P.value,"onUpdate:focused":L=>P.value=L,validationValue:r.externalValue,dirty:q,class:["v-select",{"v-select--active-menu":u.value,"v-select--chips":!!e.chips,[`v-select--${e.multiple?"multiple":"single"}`]:!0,"v-select--selected":r.value.length,"v-select--selection-slot":!!a.selection},e.class],style:e.style,inputmode:"none",placeholder:J,"onClick:clear":k,"onMousedown:control":w,onBlur:O,onKeydown:M,"aria-label":l(y.value),title:l(y.value)}),{...a,default:()=>n(ae,null,[n(yt,U({ref:i,modelValue:u.value,"onUpdate:modelValue":L=>u.value=L,activator:"parent",contentClass:"v-select__content",disabled:b.value,eager:e.eager,maxHeight:310,openOnClick:!1,closeOnContentClick:!1,transition:e.transition,onAfterLeave:G},e.menuProps),{default:()=>[B&&n(Ee,{ref:h,selected:g.value,selectStrategy:e.multiple?"independent":"single-independent",onMousedown:L=>L.preventDefault(),onKeydown:_,onFocusin:W,onScrollPassive:E,tabindex:"-1",color:e.itemColor??e.color},{default:()=>{var L,F,K;return[(L=a["prepend-item"])==null?void 0:L.call(a),!A.value.length&&!e.hideNoData&&(((F=a["no-data"])==null?void 0:F.call(a))??n(pe,{title:l(e.noDataText)},null)),n(Jl,{renderless:!0,items:A.value},{default:de=>{var we;let{item:ne,index:Q,itemRef:ye}=de;const he=U(ne.props,{ref:ye,key:Q,onClick:()=>N(ne)});return((we=a.item)==null?void 0:we.call(a,{item:ne,index:Q,props:he}))??n(pe,he,{prepend:De=>{let{isSelected:xa}=De;return n(ae,null,[e.multiple&&!e.hideSelected?n(Je,{key:ne.value,modelValue:xa,ripple:!1,tabindex:"-1"},null):void 0,ne.props.prependIcon&&n(ke,{icon:ne.props.prependIcon},null)])}})}}),(K=a["append-item"])==null?void 0:K.call(a)]}})]}),p.value.map((L,F)=>{var ne;function K(Q){Q.stopPropagation(),Q.preventDefault(),N(L)}const de={"onClick:close":K,onMousedown(Q){Q.preventDefault(),Q.stopPropagation()},modelValue:!0,"onUpdate:modelValue":void 0};return n("div",{key:L.value,class:"v-select__selection"},[C?a.chip?n(ct,{key:"chip-defaults",defaults:{VChip:{closable:e.closableChips,size:"small",text:L.title}}},{default:()=>{var Q;return[(Q=a.chip)==null?void 0:Q.call(a,{item:L,index:F,props:de})]}}):n(zl,U({key:"chip",closable:e.closableChips,size:"small",text:L.title},de),null):((ne=a.selection)==null?void 0:ne.call(a,{item:L,index:F}))??n("span",{class:"v-select__selection-text"},[L.title,e.multiple&&F<p.value.length-1&&n("span",{class:"v-select__selection-comma"},[T(",")])])])})]),"append-inner":function(){var de;for(var L=arguments.length,F=new Array(L),K=0;K<L;K++)F[K]=arguments[K];return n(ae,null,[(de=a["append-inner"])==null?void 0:de.call(a,...F),e.menuIcon?n(ke,{class:"v-select__menu-icon",icon:e.menuIcon},null):void 0])}})}),gt({isFocused:P,menu:u,select:N},o)}}),an=(e,t,a)=>e==null||t==null?-1:e.toString().toLocaleLowerCase().indexOf(t.toString().toLocaleLowerCase()),ln=z({customFilter:Function,customKeyFilter:Object,filterKeys:[Array,String],filterMode:{type:String,default:"intersection"},noFilter:Boolean},"filter");function nn(e,t,a){var u;const l=[],o=(a==null?void 0:a.default)??an,i=a!=null&&a.filterKeys?Ke(a.filterKeys):!1,s=Object.keys((a==null?void 0:a.customKeyFilter)??{}).length;if(!(e!=null&&e.length))return l;e:for(let d=0;d<e.length;d++){const f=e[d],m={},r={};let c=-1;if(t&&!(a!=null&&a.noFilter)){if(typeof f=="object"){const P=i||Object.keys(f);for(const y of P){const V=_e(f,y,f),$=(u=a==null?void 0:a.customKeyFilter)==null?void 0:u[y];if(c=$?$(V,t,f):o(V,t,f),c!==-1&&c!==!1)$?m[y]=c:r[y]=c;else if((a==null?void 0:a.filterMode)==="every")continue e}}else c=o(f,t,f),c!==-1&&c!==!1&&(r.title=c);const p=Object.keys(r).length,g=Object.keys(m).length;if(!p&&!g||(a==null?void 0:a.filterMode)==="union"&&g!==s&&!p||(a==null?void 0:a.filterMode)==="intersection"&&(g!==s||!p))continue}l.push({index:d,matches:{...r,...m}})}return l}function sn(e,t,a,l){const o=I([]),i=I(new Map),s=D(()=>l!=null&&l.transform?S(t).map(l==null?void 0:l.transform):S(t));Xe(()=>{const d=typeof a=="function"?a():S(a),f=typeof d!="string"&&typeof d!="number"?"":String(d),m=nn(s.value,f,{customKeyFilter:e.customKeyFilter,default:e.customFilter,filterKeys:e.filterKeys,filterMode:e.filterMode,noFilter:e.noFilter}),r=S(t),c=[],p=new Map;m.forEach(g=>{let{index:P,matches:y}=g;const V=r[P];c.push(V),p.set(V.value,y)}),o.value=c,i.value=p});function u(d){return i.value.get(d.value)}return{filteredItems:o,filteredMatches:i,getMatches:u}}const on=e=>{const{touchstartX:t,touchendX:a,touchstartY:l,touchendY:o}=e,i=.5,s=16;e.offsetX=a-t,e.offsetY=o-l,Math.abs(e.offsetY)<i*Math.abs(e.offsetX)&&(e.left&&a<t-s&&e.left(e),e.right&&a>t+s&&e.right(e)),Math.abs(e.offsetX)<i*Math.abs(e.offsetY)&&(e.up&&o<l-s&&e.up(e),e.down&&o>l+s&&e.down(e))};function rn(e,t){var l;const a=e.changedTouches[0];t.touchstartX=a.clientX,t.touchstartY=a.clientY,(l=t.start)==null||l.call(t,{originalEvent:e,...t})}function un(e,t){var l;const a=e.changedTouches[0];t.touchendX=a.clientX,t.touchendY=a.clientY,(l=t.end)==null||l.call(t,{originalEvent:e,...t}),on(t)}function cn(e,t){var l;const a=e.changedTouches[0];t.touchmoveX=a.clientX,t.touchmoveY=a.clientY,(l=t.move)==null||l.call(t,{originalEvent:e,...t})}function dn(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const t={touchstartX:0,touchstartY:0,touchendX:0,touchendY:0,touchmoveX:0,touchmoveY:0,offsetX:0,offsetY:0,left:e.left,right:e.right,up:e.up,down:e.down,start:e.start,move:e.move,end:e.end};return{touchstart:a=>rn(a,t),touchend:a=>un(a,t),touchmove:a=>cn(a,t)}}function mn(e,t){var u;const a=t.value,l=a!=null&&a.parent?e.parentElement:e,o=(a==null?void 0:a.options)??{passive:!0},i=(u=t.instance)==null?void 0:u.$.uid;if(!l||!i)return;const s=dn(t.value);l._touchHandlers=l._touchHandlers??Object.create(null),l._touchHandlers[i]=s,Kt(s).forEach(d=>{l.addEventListener(d,s[d],o)})}function vn(e,t){var i,s;const a=(i=t.value)!=null&&i.parent?e.parentElement:e,l=(s=t.instance)==null?void 0:s.$.uid;if(!(a!=null&&a._touchHandlers)||!l)return;const o=a._touchHandlers[l];Kt(o).forEach(u=>{a.removeEventListener(u,o[u])}),delete a._touchHandlers[l]}const oa={mounted:mn,unmounted:vn},fn=oa,ia=Symbol.for("vuetify:v-window"),ra=Symbol.for("vuetify:v-window-group"),pn=z({continuous:Boolean,nextIcon:{type:[Boolean,String,Function,Object],default:"$next"},prevIcon:{type:[Boolean,String,Function,Object],default:"$prev"},reverse:Boolean,showArrows:{type:[Boolean,String],validator:e=>typeof e=="boolean"||e==="hover"},touch:{type:[Object,Boolean],default:void 0},direction:{type:String,default:"horizontal"},modelValue:null,disabled:Boolean,selectedClass:{type:String,default:"v-window-item--active"},mandatory:{type:[Boolean,String],default:"force"},...Ye(),...$a(),...qt()},"VWindow"),ua=oe()({name:"VWindow",directives:{Touch:oa},props:pn(),emits:{"update:modelValue":e=>!0},setup(e,t){let{slots:a}=t;const{themeClasses:l}=Wt(e),{isRtl:o}=Oa(),{t:i}=Ue(),s=Ea(e,ra),u=I(),d=D(()=>o.value?!e.reverse:e.reverse),f=xe(!1),m=D(()=>{const b=e.direction==="vertical"?"y":"x",E=(d.value?!f.value:f.value)?"-reverse":"";return`v-window-${b}${E}-transition`}),r=xe(0),c=I(void 0),p=D(()=>s.items.value.findIndex(b=>s.selected.value.includes(b.id)));se(p,(b,h)=>{const E=s.items.value.length,_=E-1;E<=2?f.value=b<h:b===_&&h===0?f.value=!0:b===0&&h===_?f.value=!1:f.value=b<h}),Ae(ia,{transition:m,isReversed:f,transitionCount:r,transitionHeight:c,rootRef:u});const g=D(()=>e.continuous||p.value!==0),P=D(()=>e.continuous||p.value!==s.items.value.length-1);function y(){g.value&&s.prev()}function V(){P.value&&s.next()}const $=D(()=>{const b=[],h={icon:o.value?e.nextIcon:e.prevIcon,class:`v-window__${d.value?"right":"left"}`,onClick:s.prev,ariaLabel:i("$vuetify.carousel.prev")};b.push(g.value?a.prev?a.prev({props:h}):n(H,h,null):n("div",null,null));const E={icon:o.value?e.prevIcon:e.nextIcon,class:`v-window__${d.value?"left":"right"}`,onClick:s.next,ariaLabel:i("$vuetify.carousel.next")};return b.push(P.value?a.next?a.next({props:E}):n(H,E,null):n("div",null,null)),b}),A=D(()=>e.touch===!1?e.touch:{...{left:()=>{d.value?y():V()},right:()=>{d.value?V():y()},start:h=>{let{originalEvent:E}=h;E.stopPropagation()}},...e.touch===!0?{}:e.touch});return ue(()=>Yt(n(e.tag,{ref:u,class:["v-window",{"v-window--show-arrows-on-hover":e.showArrows==="hover"},l.value,e.class],style:e.style},{default:()=>{var b,h;return[n("div",{class:"v-window__container",style:{height:c.value}},[(b=a.default)==null?void 0:b.call(a,{group:s}),e.showArrows!==!1&&n("div",{class:"v-window__controls"},[$.value])]),(h=a.additional)==null?void 0:h.call(a,{group:s})]}}),[[Ra("touch"),A.value]])),{group:s}}}),gn=z({reverseTransition:{type:[Boolean,String],default:void 0},transition:{type:[Boolean,String],default:void 0},...Ye(),...Ba(),...Ll()},"VWindowItem"),Ve=oe()({name:"VWindowItem",directives:{Touch:fn},props:gn(),emits:{"group:selected":e=>!0},setup(e,t){let{slots:a}=t;const l=Te(ia),o=La(e,ra),{isBooted:i}=Ma();if(!l||!o)throw new Error("[Vuetify] VWindowItem must be used inside VWindow");const s=xe(!1),u=D(()=>i.value&&(l.isReversed.value?e.reverseTransition!==!1:e.transition!==!1));function d(){!s.value||!l||(s.value=!1,l.transitionCount.value>0&&(l.transitionCount.value-=1,l.transitionCount.value===0&&(l.transitionHeight.value=void 0)))}function f(){var g;s.value||!l||(s.value=!0,l.transitionCount.value===0&&(l.transitionHeight.value=ve((g=l.rootRef.value)==null?void 0:g.clientHeight)),l.transitionCount.value+=1)}function m(){d()}function r(g){s.value&&Xt(()=>{!u.value||!s.value||!l||(l.transitionHeight.value=ve(g.clientHeight))})}const c=D(()=>{const g=l.isReversed.value?e.reverseTransition:e.transition;return u.value?{name:typeof g!="string"?l.transition.value:g,onBeforeEnter:f,onAfterEnter:d,onEnterCancelled:m,onBeforeLeave:f,onAfterLeave:d,onLeaveCancelled:m,onEnter:r}:!1}),{hasContent:p}=Ml(e,o.isSelected);return ue(()=>n(Ua,{transition:c.value,disabled:!i.value},{default:()=>{var g;return[Yt(n("div",{class:["v-window-item",o.selectedClass.value,e.class],style:e.style},[p.value&&((g=a.default)==null?void 0:g.call(a))]),[[Fa,o.isSelected.value]])]}})),{groupItem:o}}});const yn=z({fullscreen:Boolean,retainFocus:{type:Boolean,default:!0},scrollable:Boolean,...ta({origin:"center center",scrollStrategy:"block",transition:{component:la},zIndex:2400})},"VDialog"),et=oe()({name:"VDialog",props:yn(),emits:{"update:modelValue":e=>!0},setup(e,t){let{slots:a}=t;const l=ge(e,"modelValue"),{scopeId:o}=aa(),i=I();function s(d){var r,c;const f=d.relatedTarget,m=d.target;if(f!==m&&((r=i.value)!=null&&r.contentEl)&&((c=i.value)!=null&&c.globalTop)&&![document,i.value.contentEl].includes(m)&&!i.value.contentEl.contains(m)){const p=ja(i.value.contentEl);if(!p.length)return;const g=p[0],P=p[p.length-1];f===g?P.focus():g.focus()}}Ha&&se(()=>l.value&&e.retainFocus,d=>{d?document.addEventListener("focusin",s):document.removeEventListener("focusin",s)},{immediate:!0}),se(l,async d=>{var f,m;await Xt(),d?(f=i.value.contentEl)==null||f.focus({preventScroll:!0}):(m=i.value.activatorEl)==null||m.focus({preventScroll:!0})});const u=D(()=>U({"aria-haspopup":"dialog","aria-expanded":String(l.value)},e.activatorProps));return ue(()=>{const[d]=We.filterProps(e);return n(We,U({ref:i,class:["v-dialog",{"v-dialog--fullscreen":e.fullscreen,"v-dialog--scrollable":e.scrollable},e.class],style:e.style},d,{modelValue:l.value,"onUpdate:modelValue":f=>l.value=f,"aria-modal":"true",activatorProps:u.value,role:"dialog"},o),{activator:a.activator,default:function(){for(var f=arguments.length,m=new Array(f),r=0;r<f;r++)m[r]=arguments[r];return n(ct,{root:"VDialog"},{default:()=>{var c;return[(c=a.default)==null?void 0:c.call(a,...m)]}})}})}),gt({},i)}}),hn=z({...Ul({falseIcon:"$radioOff",trueIcon:"$radioOn"})},"VRadio"),bn=oe()({name:"VRadio",props:hn(),setup(e,t){let{slots:a}=t;return ue(()=>n(na,U(e,{class:["v-radio",e.class],style:e.style,type:"radio"}),a)),{}}});const _n=z({height:{type:[Number,String],default:"auto"},...Hl(),...ut(jl(),["multiple"]),trueIcon:{type:Be,default:"$radioOn"},falseIcon:{type:Be,default:"$radioOff"},type:{type:String,default:"radio"}},"VRadioGroup"),Sn=oe()({name:"VRadioGroup",inheritAttrs:!1,props:_n(),emits:{"update:modelValue":e=>!0},setup(e,t){let{attrs:a,slots:l}=t;const o=Na(),i=D(()=>e.id||`radio-group-${o}`),s=ge(e,"modelValue");return ue(()=>{const[u,d]=Ga(a),[f,m]=$t.filterProps(e),[r,c]=na.filterProps(e),p=l.label?l.label({label:e.label,props:{for:i.value}}):e.label;return n($t,U({class:["v-radio-group",e.class],style:e.style},u,f,{modelValue:s.value,"onUpdate:modelValue":g=>s.value=g,id:i.value}),{...l,default:g=>{let{id:P,messagesId:y,isDisabled:V,isReadonly:$}=g;return n(ae,null,[p&&n(Nl,{id:P.value},{default:()=>[p]}),n(Gl,U(r,{id:P.value,"aria-describedby":y.value,defaultsTarget:"VRadio",trueIcon:e.trueIcon,falseIcon:e.falseIcon,type:e.type,disabled:V.value,readonly:$.value,"aria-labelledby":p?P.value:void 0,multiple:!1},d,{modelValue:s.value,"onUpdate:modelValue":A=>s.value=A}),l)])}})}),{}}});const wn=z({multiLine:Boolean,timeout:{type:[Number,String],default:5e3},vertical:Boolean,...za({location:"bottom"}),...Ka(),...qa(),...Wa(),...qt(),...ut(ta({transition:"v-snackbar-transition"}),["persistent","noClickAnimation","scrim","scrollStrategy"])},"VSnackbar"),Pn=oe()({name:"VSnackbar",props:wn(),emits:{"update:modelValue":e=>!0},setup(e,t){let{slots:a}=t;const l=ge(e,"modelValue"),{locationStyles:o}=Ya(e),{positionClasses:i}=Xa(e),{scopeId:s}=aa(),{themeClasses:u}=Wt(e),{colorClasses:d,colorStyles:f,variantClasses:m}=Qa(e),{roundedClasses:r}=Ja(e),c=I();se(l,g),se(()=>e.timeout,g),rt(()=>{l.value&&g()});let p=-1;function g(){window.clearTimeout(p);const y=Number(e.timeout);!l.value||y===-1||(p=window.setTimeout(()=>{l.value=!1},y))}function P(){window.clearTimeout(p)}return ue(()=>{const[y]=We.filterProps(e);return n(We,U({ref:c,class:["v-snackbar",{"v-snackbar--active":l.value,"v-snackbar--multi-line":e.multiLine&&!e.vertical,"v-snackbar--vertical":e.vertical},i.value,e.class],style:e.style},y,{modelValue:l.value,"onUpdate:modelValue":V=>l.value=V,contentProps:U({class:["v-snackbar__wrapper",u.value,d.value,r.value,m.value],style:[o.value,f.value],onPointerenter:P,onPointerleave:g},y.contentProps),persistent:!0,noClickAnimation:!0,scrim:!1,scrollStrategy:"none",_disableGlobalStack:!0},s),{default:()=>[Za(!1,"v-snackbar"),a.default&&n("div",{class:"v-snackbar__content",role:"status","aria-live":"polite"},[a.default()]),a.actions&&n(ct,{defaults:{VBtn:{variant:"text",ripple:!1}}},{default:()=>[n("div",{class:"v-snackbar__actions"},[a.actions()])]})],activator:a.activator})}),gt({},c)}});let ze;const Vn=new Uint8Array(16);function xn(){if(!ze&&(ze=typeof crypto<"u"&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto),!ze))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return ze(Vn)}const Z=[];for(let e=0;e<256;++e)Z.push((e+256).toString(16).slice(1));function kn(e,t=0){return(Z[e[t+0]]+Z[e[t+1]]+Z[e[t+2]]+Z[e[t+3]]+"-"+Z[e[t+4]]+Z[e[t+5]]+"-"+Z[e[t+6]]+Z[e[t+7]]+"-"+Z[e[t+8]]+Z[e[t+9]]+"-"+Z[e[t+10]]+Z[e[t+11]]+Z[e[t+12]]+Z[e[t+13]]+Z[e[t+14]]+Z[e[t+15]]).toLowerCase()}const Cn=typeof crypto<"u"&&crypto.randomUUID&&crypto.randomUUID.bind(crypto),Bt={randomUUID:Cn};function An(e,t,a){if(Bt.randomUUID&&!t&&!e)return Bt.randomUUID();e=e||{};const l=e.random||(e.rng||xn)();if(l[6]=l[6]&15|64,l[8]=l[8]&63|128,t){a=a||0;for(let o=0;o<16;++o)t[a+o]=l[o];return t}return kn(l)}function bt(){return{id:()=>An()}}const Lt=(e,t)=>e?t.findIndex(a=>a.name===e.name):-1,_t=Qt("assays",()=>{const e=Dl("web-assays",[]),t=D(()=>e.value.length===0);return{assays:e,empty:t,add:o=>{Lt(o,e.value)===-1&&e.value.push(o)},remove:o=>{const i=Lt(o,e.value);i!==-1&&e.value.splice(i,1)}}}),Mt=["Analysing peptides","Computing GO count table","Computing GO ontology","Computing EC count table","Computing EC ontology","Computing InterPro count table","Computing InterPro ontology","Computing lowest common ancestors","Computing NCBI ontology","Computing taxonomic tree","Analysis completed"],Ft=["Calculating sequences subset","Filter count table","Compute filtered GO count table","Compute filtered EC count table","Compute filtered InterPro count table","filtering completed"],Se=Qt("multi-analysis",()=>{const e=ft(),t=new el(e.unipeptApiUrl,e.peptideDataBatchSize,e.cleavageBatchSize,e.parallelRequests);Vt.setup(e.unipeptApiUrl,e.goBatchSize);const a=new Vt;xt.setup(e.unipeptApiUrl,e.ecBatchSize);const l=new xt;kt.setup(e.unipeptApiUrl,e.interproBatchSize);const o=new kt;Ct.setup(e.unipeptApiUrl,e.ncbiBatchSize);const i=new Ct,s=I([]),u=I(void 0),d=D(()=>s.value.length===0),f=D(()=>{var _;return((_=u.value)==null?void 0:_.analysisInProgress)||!1}),m=_=>s.value.findIndex(k=>k.assay.id==_),r=(_,k,w,M)=>{const N=m(_.id),O=M?s.value[N].filterProgress:s.value[N].progress;O.currentValue=k,O.currentStep=w;const G=new Date().getTime();w>0&&(O.steps[w-1].end=G),O.steps[w].start===0&&(O.steps[w].start=G);const W=G-O.steps[0].start;if(W>500){O.eta=W*(100-k)/k;return}O.eta=-1},c=async(_,k,w,M)=>{const N=m(_.id),O=s.value[N];O.equateIl=k,O.filterDuplicates=w,O.cleavageHandling=M,u.value||(u.value=O),O.analysisInProgress=!0,O.analysisReady=!1,O.error={status:!1,message:"",object:null};try{const W=await new nt().getPeptideCountTable(tl(_.peptides),O.cleavageHandling,O.filterDuplicates,O.equateIl),[le,C]=await t.process(W,O.cleavageHandling,O.equateIl,{onProgressUpdate(De){r(_,Math.round(De*100)-10,0,!1)}});r(_,91,1,!1);const B=new At(W,le,a);await B.compute(),r(_,92,2,!1);const Y=await new al(a).getOntology(B.getCountTable());r(_,93,3,!1);const J=new Tt(W,le,l);await J.compute(),r(_,94,4,!1);const F=await new ll(l).getOntology(J.getCountTable());r(_,95,5,!1);const K=new It(W,le,o);await K.compute(),r(_,96,6,!1);const ne=await new nl(o).getOntology(K.getCountTable());r(_,97,7,!1);const Q=new sl(W,le);await Q.compute(),r(_,98,8,!1);const he=await new ol(i).getOntology(Q.getCountTable());r(_,99,9,!1);const we=new Dt(Q.getCountTable(),he,Q.getAnnotationPeptideMapping());O.assay=_,O.pept2Data=le,O.goOntology=Y,O.ecOntology=F,O.interproOntology=ne,O.ncbiOntology=he,O.data={peptideCountTable:W,goCountTableProcessor:B,ecCountTableProcessor:J,interproCountTableProcessor:K,lcaCountTableProcessor:Q,tree:we,trust:C},O.filteredData={peptideCountTable:W,goCountTableProcessor:B,ecCountTableProcessor:J,interproCountTableProcessor:K,percentage:5,trust:C}}catch(G){console.error(G),O.error={status:!0,message:G.message,object:G}}finally{O.analysisInProgress=!1,O.analysisReady=!O.error.status,O.filterReady=!O.error.status,r(_,100,10,!1)}},p=async _=>{const k=m(_),w=s.value[k],M=w.filterId,N=w.filterPercentage;w.filterInProgress=!0,w.filterReady=!1,w.error={status:!1,message:"",object:null},r(w.assay,-1,0,!0);const O=async function(G,W,le){const C=W.getCountTable(),B=W.getAnnotationPeptideMapping(),q=new Dt(C,le),Y=[],L=[q.nodes.get(G)];for(;L.length>0;){const F=L.pop();F&&B.has(F.id)&&Y.push(...B.get(F==null?void 0:F.id)),F!=null&&F.children&&L.push(...F.children)}return Y};try{const G=w.data.lcaCountTableProcessor;r(w.assay,-1,1,!0);const W=await O(M,G,w.ncbiOntology),C=await new nt().getPeptideCountTable(W,w.cleavageHandling,w.filterDuplicates,w.equateIl),q=new il().getPeptideTrust(C,w.pept2Data);r(w.assay,-1,2,!0);const Y=new At(C,w.pept2Data,a,N);await Y.compute(),r(w.assay,-1,3,!0);const J=new Tt(C,w.pept2Data,l,N);await J.compute(),r(w.assay,-1,4,!0);const L=new It(C,w.pept2Data,o,N);await L.compute(),w.filteredData={peptideCountTable:C,goCountTableProcessor:Y,ecCountTableProcessor:J,interproCountTableProcessor:L,percentage:N,trust:q}}catch(G){console.error(G),w.error={status:!0,message:G.message,object:G}}finally{w.filterInProgress=!1,w.filterReady=!0,r(w.assay,-1,5,!0)}};return{assayStatuses:s,activeAssayStatus:u,empty:d,done:f,analysisCompleted:_=>{const k=m(_),w=s.value[k];return w.analysisReady&&!w.analysisInProgress},addAssay:_=>{if(m(_.id)===-1){const k=Ne.constructProgressObject(Ft);k.currentStep=5,s.value.push({assay:_,progress:Ne.constructProgressObject(Mt),filterProgress:k})}},resetAssay:_=>{var w;const k=m(_.id);if(k!==-1){const M=Ne.constructProgressObject(Ft);M.currentStep=5,s.value[k]={assay:_,progress:Ne.constructProgressObject(Mt),filterProgress:M},((w=u.value)==null?void 0:w.assay.id)===_.id&&(u.value=s.value[k])}},removeAssay:_=>{const k=m(_.id);k!==-1&&(s.value.splice(k,1),s.value.length>0?u.value=s.value[0]:u.value=void 0)},removeAllAssays:()=>{s.value.splice(0,s.value.length),u.value=void 0},activateAssay:_=>{const k=m(_.id);u.value=s.value[k]},analyse:c,filter:p,filterAssayByRank:(_,k)=>{const w=m(_);s.value[w].filterId=k,p(_)},filterAssayByPercentage:(_,k)=>{const w=m(_);s.value[w].filterPercentage=k,p(_)},filterCompleted:_=>{const k=m(_);return s.value[k].filterProgress.currentStep===5}}}),Tn={class:"d-flex justify-center mt-2"},In=ce({__name:"CreateDatasetCard",setup(e){const t=_t(),a=Se(),{id:l}=bt(),o=I(null),i=I(!1),s=I(""),u=I(""),d=[r=>!!r||"At least one peptide is required"],f=[r=>!!r||"Name is required when the dataset is set to be saved"],m=()=>{var p;const r=s.value.split(`
`),c={id:l(),name:u.value,peptides:r,amountOfPeptides:r.length,createdAt:new Date};t.add(c),a.addAssay(c),(p=o.value)==null||p.reset()};return(r,c)=>(R(),j(re,{flat:""},{default:v(()=>[n(ie,null,{default:v(()=>[n(S(it),{ref_key:"form",ref:o,modelValue:i.value,"onUpdate:modelValue":c[2]||(c[2]=p=>i.value=p)},{default:v(()=>[n(be,{class:"my-1"},{default:v(()=>[n(me,{class:"pb-0",cols:"12"},{default:v(()=>[n(pt,{modelValue:s.value,"onUpdate:modelValue":c[0]||(c[0]=p=>s.value=p),class:"pt-0 mt-0",label:"Peptide list",rules:d,spellcheck:!1,rows:7,clearable:"","no-resize":""},null,8,["modelValue"])]),_:1})]),_:1}),n(ee,{text:"This name will be shown on the results page. Handy if you have many open tabs."},{activator:v(({props:p})=>[n(Me,U({modelValue:u.value,"onUpdate:modelValue":c[1]||(c[1]=g=>u.value=g),label:"Name this dataset",placeholder:"e.g. Sample B5",rules:f,clearable:""},p),null,16,["modelValue"])]),_:1}),x("div",Tn,[n(H,{class:"text-center","prepend-icon":"mdi-plus",disabled:!i.value,onClick:m},{default:v(()=>[T(" Add to selected datasets ")]),_:1},8,["disabled"])])]),_:1},8,["modelValue"])]),_:1})]),_:1}))}}),Dn=x("span",{id:"empty-dataset-placeholder"}," There are currently no datasets present in your browser's local storage. ",-1),$n={class:"d-flex justify-end"},On=ce({__name:"LoadLocalDatasetCard",setup(e){const t=_t(),a=Se(),l=I(!1),o=I(),i=m=>{a.addAssay(m)},s=m=>{m&&(t.remove(m),a.removeAssay(m))},u=m=>{l.value=!0,o.value=m},d=()=>{l.value=!1,o.value=void 0},f=m=>{m=new Date(m);const r=m.getFullYear(),c=m.getMonth()+1;return`${m.getDate()}/${c}/${r}`};return(m,r)=>(R(),j(re,{flat:""},{default:v(()=>[S(t).empty?(R(),j(ie,{key:0},{default:v(()=>[Dn]),_:1})):Le("",!0),n(Ee,{"two-line":"",class:"stored-assays-list"},{default:v(()=>[(R(!0),te(ae,null,Qe(S(t).assays,c=>(R(),j(pe,{key:c.name,title:c.name,subtitle:c.amountOfPeptides+" peptides","prepend-icon":"mdi-plus",ripple:"",onClick:p=>i(c)},{prepend:v(()=>[n(ee,{text:"Select this dataset for analysis."},{activator:v(({props:p})=>[n(ke,rl(ul(p)),{default:v(()=>[T(" mdi-plus ")]),_:2},1040)]),_:1})]),append:v(()=>[x("div",$n,[x("span",null,X(f(c.createdAt)),1),n(ee,{text:"Delete this sample from local storage."},{activator:v(({props:p})=>[n(H,U({class:"remove-assay-button",icon:"mdi-close"},p,{onClick:st(g=>u(c),["stop"])}),null,16,["onClick"])]),_:2},1024)])]),_:2},1032,["title","subtitle","onClick"]))),128))]),_:1}),n(et,{modelValue:l.value,"onUpdate:modelValue":r[1]||(r[1]=c=>l.value=c),"max-width":"400"},{default:v(()=>[n(re,null,{default:v(()=>[n(Ce,null,{default:v(()=>[T("Confirm sample deletion?")]),_:1}),n(ie,null,{default:v(()=>{var c;return[T(' Are you sure you want to permanently delete "'+X((c=o.value)==null?void 0:c.name)+'" from your browser? This operation cannot be undone. ',1)]}),_:1}),n(ea,null,{default:v(()=>[n(Oe),n(H,{class:"confirmation-cancel-button",color:"black",variant:"text",onClick:d},{default:v(()=>[T(" Cancel ")]),_:1}),n(H,{color:"primary",variant:"text",onClick:r[0]||(r[0]=c=>{s(o.value),d()})},{default:v(()=>[T(" OK ")]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1}))}}),He=e=>(dt("data-v-4076182b"),e=e(),mt(),e),En={key:0,style:{display:"flex","justify-content":"center"}},Rn={key:1,class:"connection-error"},Bn=He(()=>x("b",null,"Environment: ",-1)),Ln=He(()=>x("br",null,null,-1)),Mn=He(()=>x("b",null,"Reference: ",-1)),Fn=["href"],Un=["href"],Hn=He(()=>x("span",{class:"glyphicon glyphicon-share-alt"},null,-1)),jn=He(()=>x("br",null,null,-1)),Nn={class:"load-sample-container"},Gn=ce({__name:"LoadSampleDatasetCard",setup(e){const t=Se(),a=ft(),{id:l}=bt(),o=I(!1),i=I(!1),s=[],u=I({}),d=()=>{o.value=!0,i.value=!1,fetch(`${a.unipeptApiUrl}/datasets/sampledata`,{method:"POST",body:JSON.stringify({})}).then(m=>m.json()).then(m=>{for(const r of m.sample_data){const c=r.datasets.map(p=>({id:l(),name:p.name,data:p.data,order:p.order})).sort((p,g)=>p.order-g.order);s.push({id:r.id,environment:r.environment,projectWebsite:r.project_website,reference:r.reference,url:r.url,datasets:c}),u.value[r.id]=c[0].name}}).catch(()=>i.value=!0).finally(()=>o.value=!1)},f=m=>{const c=s.find(p=>p.id==m).datasets.find(p=>p.name==u.value[m]);t.addAssay({id:c.id,name:c.name,peptides:c.data,amountOfPeptides:c.data.length,createdAt:new Date})};return rt(d),(m,r)=>(R(),j(re,{flat:""},{default:v(()=>[n(ie,null,{default:v(()=>[o.value?(R(),te("div",En,[n(qe,{indeterminate:"",color:"primary"})])):i.value?(R(),te("div",Rn,[n(Fe,{type:"error"},{default:v(()=>[T(" Unable to retrieve list of sample datasets. ")]),_:1})])):(R(),te(ae,{key:2},Qe(s,c=>x("div",{key:c.id},[Bn,T(" "+X(c.environment)+" ",1),Ln,Mn,x("small",null,[T(X(c.reference)+" ",1),x("a",{class:"link",target:"_blank",title:"Article website",href:c.url},[n(ke,{class:"pb-1 text-primary",size:"small"},{default:v(()=>[T(" mdi-link-variant ")]),_:1})],8,Fn),x("a",{class:"link",target:"_blank",title:"Project website",href:c.projectWebsite},[Hn,n(ke,{class:"pb-1 text-primary",size:"small"},{default:v(()=>[T(" mdi-share ")]),_:1})],8,Un)]),jn,x("div",Nn,[n(be,null,{default:v(()=>[n(me,{cols:7},{default:v(()=>[n(sa,{modelValue:u.value[c.id],"onUpdate:modelValue":p=>u.value[c.id]=p,items:c.datasets,"item-title":"name",variant:"underlined"},null,8,["modelValue","onUpdate:modelValue","items"])]),_:2},1024),n(me,{cols:5,style:{display:"flex","align-items":"center"},class:"load-dataset-button"},{default:v(()=>[n(H,{onClick:p=>f(c.id)},{default:v(()=>[T(" Load dataset ")]),_:2},1032,["onClick"])]),_:2},1024)]),_:2},1024)])])),64))]),_:1})]),_:1}))}});const zn=Ze(Gn,[["__scopeId","data-v-4076182b"]]),Kn=x("h3",null,"Load data from the PRIDE archive",-1),qn=x("p",null,[T(" You can easily load data from the "),x("a",{href:"http://www.ebi.ac.uk/pride/",target:"_blank",class:"link"}," PRIDE "),T(" data repository. Simply enter an assay id (e.g. 8500) in the field below and click the 'Load PRIDE Dataset' button. The corresponding dataset will then be fetched using the PRIDE API and loaded into the search form on the left. ")],-1),Wn={class:"d-flex justify-center mt-2"},Yn={class:"d-flex justify-center mt-2"},Xn=ce({__name:"LoadPrideDatasetCard",setup(e){const t=_t(),a=Se(),l=ft(),{id:o}=bt(),i=I(!1),s=I(""),u=I(!1),d=I(""),f=I(null),m=I(!1),r=I(""),c=I(""),p=[$=>!!$||"Please enter a valid PRIDE assay number"],g=[$=>!!$||"At least one peptide is required"],P=[$=>!!$||"Name is required when the dataset is set to be saved"],y=$=>{if($.preventDefault(),i.value)return;i.value=!0,s.value="",r.value="",c.value="PRIDE assay "+d.value,new dl(l.prideApiPeptideUrl,l.prideBatchSize).getPeptides(d.value).then(b=>{b.length==0?s.value="This PRIDE assay contains no peptides.":r.value=b.join(`
`)}).catch(()=>s.value="Unable to fetch the PRIDE assay.").finally(()=>i.value=!1)},V=()=>{var b;const $=r.value.split(`
`),A={id:o(),name:c.value,peptides:$,amountOfPeptides:$.length,createdAt:new Date};t.add(A),a.addAssay(A),(b=f.value)==null||b.reset()};return($,A)=>(R(),j(re,{flat:""},{default:v(()=>[n(ie,null,{default:v(()=>[Kn,qn,n(S(it),{modelValue:u.value,"onUpdate:modelValue":A[1]||(A[1]=b=>u.value=b),onSubmit:y},{default:v(()=>[n(Me,{modelValue:d.value,"onUpdate:modelValue":A[0]||(A[0]=b=>d.value=b),label:"Assay id",placeholder:"e.g. 123909",disabled:i.value,rules:p,onKeyup:cl(y,["enter"])},null,8,["modelValue","disabled","onKeyup"]),x("div",Wn,[n(H,{class:"text-center",disabled:!u.value||i.value,type:"submit","prepend-icon":"mdi-cloud-download"},{default:v(()=>[T(" Fetch PRIDE dataset ")]),_:1},8,["disabled"])])]),_:1},8,["modelValue"])]),_:1}),n(ht),s.value?(R(),j(ie,{key:0,class:"connection-error"},{default:v(()=>[n(Fe,{type:"error"},{default:v(()=>[T(X(s.value),1)]),_:1})]),_:1})):(R(),j(ie,{key:1,class:"pt-0"},{default:v(()=>[n(S(it),{ref_key:"form",ref:f,modelValue:m.value,"onUpdate:modelValue":A[4]||(A[4]=b=>m.value=b)},{default:v(()=>[n(be,{class:"my-1"},{default:v(()=>[n(me,{class:"pb-0",cols:"12"},{default:v(()=>[n(pt,{modelValue:r.value,"onUpdate:modelValue":A[2]||(A[2]=b=>r.value=b),class:"pt-0 mt-0",label:"Peptide list",loading:i.value,rules:g,spellcheck:!1,rows:7,clearable:"","no-resize":""},null,8,["modelValue","loading"])]),_:1})]),_:1}),n(ee,{text:"This name will be shown on the results page. Handy if you have many open tabs."},{activator:v(({props:b})=>[n(Me,U({modelValue:c.value,"onUpdate:modelValue":A[3]||(A[3]=h=>c.value=h),label:"Name this dataset",placeholder:"e.g. PRIDE assay 123909",loading:i.value,rules:P,clearable:""},b),null,16,["modelValue","loading"])]),_:1}),x("div",Yn,[n(H,{class:"text-center",disabled:!m.value,"prepend-icon":"mdi-plus",onClick:V},{default:v(()=>[T(" Add to selected datasets ")]),_:1},8,["disabled"])])]),_:1},8,["modelValue"])]),_:1}))]),_:1}))}}),Qn=ce({__name:"LoadDatasetsCard",setup(e){const t=I("create"),a=I(!1);return(l,o)=>(R(),j(re,null,{default:v(()=>[n(Jt,{modelValue:t.value,"onUpdate:modelValue":o[0]||(o[0]=i=>t.value=i),"slider-color":"secondary","bg-color":"primary",dark:""},{default:v(()=>[n(Pe,{value:"create"},{default:v(()=>[T(" Create ")]),_:1}),n(Pe,{value:"sample-data"},{default:v(()=>[T(" Sample data ")]),_:1}),n(Pe,{value:"pride"},{default:v(()=>[T(" Pride ")]),_:1}),n(Pe,{value:"local"},{default:v(()=>[T(" Local data ")]),_:1})]),_:1},8,["modelValue"]),n(ua,{modelValue:t.value,"onUpdate:modelValue":o[1]||(o[1]=i=>t.value=i)},{default:v(()=>[n(Ve,{value:"create"},{default:v(()=>[n(In)]),_:1}),n(Ve,{value:"sample-data"},{default:v(()=>[n(zn)]),_:1}),n(Ve,{value:"pride"},{default:v(()=>[n(Xn)]),_:1}),n(Ve,{value:"local"},{default:v(()=>[n(On)]),_:1})]),_:1},8,["modelValue"]),n(Pn,{modelValue:a.value,"onUpdate:modelValue":o[3]||(o[3]=i=>a.value=i),color:"error","multi-line":"",timeout:0,location:"top"},{default:v(()=>[T(" Could not save this assay due to storage restrictions. You can still analyse the assay now, but you will not be able to restore it in future sessions. Please delete some unused assays to make space for this one. "),n(H,{color:"white",variant:"text",onClick:o[2]||(o[2]=i=>a.value=!1)},{default:v(()=>[T(" Close ")]),_:1})]),_:1},8,["modelValue"])]),_:1}))}});class St{async logRoute(t){this.logPageView(t.path),Object.keys(t.params).length!==0&&this.logSearchTpa(t.params.sequence,t.query.equate==="true")}logSearchMpa(t,a,l,o,i){this.logEvent("search_mpa",{event_name:"mpa",sequenceAmount:t,equateIl:a,filterDuplicates:l,missedCleavages:o,reprocessed:i})}logDownloadMpa(t){this.logEvent("download_mpa",{event_name:"mpa",download_format:t})}logDownloadVisualization(t,a,l){this.logEvent("download_visualisation",{event_name:"visualisation",analysis:t,download_format:a,visualisation:l})}logEvent(t,a){this.gtag("config","G-P3VRXFGD5B",{send_page_view:!1}),this.gtag("event",t,a)}logPageView(t){this.logEvent("page_view",{page_title:t})}logSearchTpa(t,a){this.logEvent("search_tpa",{event_name:"tpa",sequence:t,equateIl:a})}gtag(){window.dataLayer=window.dataLayer||[],window.dataLayer.push(arguments)}}const Jn={class:"flex-grow-1"},Zn=x("h3",{class:"mb-2"}," Selected datasets ",-1),es={class:"d-flex flex-column align-end"},ts={class:"text-body-2 text-medium-emphasis"},as={class:"dark-label"},ls=x("h3",{class:"mb-2"}," Search settings ",-1),ns={class:"d-flex justify-center mt-4"},ss=ce({__name:"SelectDatasetCard",emits:["search"],setup(e,{emit:t}){const a=Se(),l=I(!1),o=I(!0),i=I(!0),s=I(!1),u=r=>{a.removeAssay(r)},d=()=>{a.removeAllAssays()},f=()=>{a.assayStatuses.forEach(r=>{new St().logSearchMpa(r.assay.amountOfPeptides,o.value,i.value,s.value,!1),a.analyse(r.assay,o.value,i.value,s.value)}),t("search")},m=r=>{r=new Date(r);const c=r.getFullYear(),p=r.getMonth()+1;return`${r.getDate()}/${p}/${c}`};return(r,c)=>(R(),j(re,{class:"d-flex flex-column flex-grow-1"},{default:v(()=>[n(Ce,{class:"bg-primary text-white"},{default:v(()=>[T(" Metaproteomics analysis ")]),_:1}),n(ie,{class:"mt-4 d-flex flex-column"},{default:v(()=>[x("div",Jn,[x("div",null,[Zn,S(a).empty?(R(),te("span",{key:0,class:ml({shaking:l.value,"selected-placeholder":!0})}," Please select one or more datasets from the right hand panel to continue the analysis. ",2)):Le("",!0)]),n(Ee,{"two-line":""},{default:v(()=>[(R(!0),te(ae,null,Qe(S(a).assayStatuses,p=>(R(),j(pe,{key:p.assay.id,"two-line":"",title:p.assay.name,subtitle:p.assay.amountOfPeptides+" peptides",class:"py-4"},{append:v(()=>[x("div",es,[x("span",ts,X(m(p.assay.createdAt)),1),n(ee,{text:"Remove dataset from analysis."},{activator:v(({props:g})=>[n(H,U({class:"fix-icon-list-position",variant:"text",icon:"mdi-delete-outline"},g,{size:"small",density:"compact",onClick:P=>u(p.assay)}),null,16,["onClick"])]),_:2},1024)])]),_:2},1032,["title","subtitle"]))),128))]),_:1})]),x("div",as,[ls,n(ee,{text:"Equate isoleucine (I) and leucine (L) when matching peptides to UniProt entries."},{activator:v(({props:p})=>[n($e,U({modelValue:o.value,"onUpdate:modelValue":c[0]||(c[0]=g=>o.value=g),class:"pt-0 mt-0",density:"compact",label:"Equate I and L"},p,{"hide-details":"",color:"primary",inset:""}),null,16,["modelValue"])]),_:1}),n(ee,{text:"Remove duplicate peptides from the input before searching."},{activator:v(({props:p})=>[n($e,U({modelValue:i.value,"onUpdate:modelValue":c[1]||(c[1]=g=>i.value=g),class:"pt-0 mt-0",density:"compact",label:"Filter duplicate peptides"},p,{"hide-details":"",color:"primary",inset:""}),null,16,["modelValue"])]),_:1}),n(ee,{text:"Recombine subpeptides of miscleavages. Enabling this has a serious performance impact!"},{activator:v(({props:p})=>[n($e,U({modelValue:s.value,"onUpdate:modelValue":c[2]||(c[2]=g=>s.value=g),class:"pt-0 mt-0",density:"compact",label:"Advanced missed cleavage handling"},p,{"hide-details":"",color:"primary",inset:""}),null,16,["modelValue"])]),_:1}),x("div",ns,[n(H,{class:"text-center",color:"primary","prepend-icon":"mdi-magnify",onClick:f},{default:v(()=>[T(" Search ")]),_:1}),n(H,{class:"text-center ml-3","prepend-icon":"mdi-restore",onClick:d},{default:v(()=>[T(" Start over ")]),_:1})])])]),_:1})]),_:1}))}});const os=x("span",null,"Please add one or more datasets by clicking the plus button above...",-1),is={class:"flex-grow-1"},rs={class:"d-flex flex-column align-end mr-2"},us={class:"text-body-2 text-medium-emphasis"},cs={class:"text-center pt-4"},ds={class:"justify-end"},ms={key:1,style:{display:"flex","justify-content":"center"}},vs={class:"text-xs-center",style:{"margin-top":"25px"}},fs=ce({__name:"SwitchDatasetCard",props:{assaySelectionInProgress:{type:Boolean,default:!1}},setup(e){const t=Se(),{assayStatuses:a}=vt(t),l=I(!1),o=f=>!f.analysisInProgress,i=f=>f.progress.currentValue===-1,s=f=>{t.activateAssay(f)},u=f=>{t.removeAssay(f)},d=f=>{f=new Date(f);const m=f.getFullYear(),r=f.getMonth()+1;return`${f.getDate()}/${r}/${m}`};return(f,m)=>(R(),j(re,{class:"d-flex flex-column"},{default:v(()=>[n(Ce,{class:"bg-primary text-white"},{default:v(()=>[T(" Metaproteomics analysis ")]),_:1}),S(t).empty?(R(),j(ie,{key:0},{default:v(()=>[os]),_:1})):(R(),j(ie,{key:1,class:"d-flex flex-column px-0"},{default:v(()=>[x("div",is,[n(Ee,{modelValue:S(t).activeAssayStatus,"onUpdate:modelValue":m[1]||(m[1]=r=>S(t).activeAssayStatus=r),"two-line":""},{default:v(()=>[(R(!0),te(ae,null,Qe(S(a),r=>(R(),j(pe,{key:r.assay.id,value:r,ripple:"",title:r.assay.name,subtitle:o(r)?r.assay.amountOfPeptides+" peptides":i(r)?"Computing estimated time remaining...":"~"+S(fl).secondsToTimeString(r.progress.eta/1e3)+" remaining...",class:"pa-4",onClick:c=>s(r.assay)},{prepend:v(()=>[r.analysisReady?(R(),j(Sn,{key:0,modelValue:S(t).activeAssayStatus,"onUpdate:modelValue":m[0]||(m[0]=c=>S(t).activeAssayStatus=c),"hide-details":"",color:"primary",class:"mr-2"},{default:v(()=>[n(bn,{value:r},null,8,["value"])]),_:2},1032,["modelValue"])):r.error.status?(R(),j(Ol,{key:1},{default:v(()=>[n(ee,{text:`An error occurred during analysis: ${r.error.message}.`},{activator:v(({props:c})=>[n(ke,U(c,{color:"error"}),{default:v(()=>[T(" mdi-alert-circle-outline ")]),_:2},1040)]),_:2},1032,["text"])]),_:2},1024)):(R(),j(qe,{key:2,rotate:-90,size:24,style:{"margin-left":"8px","margin-right":"16px"},value:r.progress.currentValue,color:"primary"},null,8,["value"]))]),append:v(()=>[x("div",rs,[x("span",us,X(d(r.assay.createdAt)),1),n(ee,{text:"Remove dataset from analysis."},{activator:v(({props:c})=>[n(H,U({class:"fix-icon-list-position",variant:"text",icon:"mdi-delete-outline"},c,{size:"small",density:"compact",onClick:p=>u(r.assay)}),null,16,["onClick"])]),_:2},1024)])]),_:2},1032,["value","title","subtitle","onClick"]))),128))]),_:1},8,["modelValue"])]),n(ht),x("div",cs,[n(ee,{text:"Compare samples above using a heatmap."},{activator:v(({props:r})=>[n(H,U(r,{onClick:m[2]||(m[2]=c=>l.value=!0)}),{default:v(()=>[T(" Compare samples ")]),_:2},1040)]),_:1})])]),_:1})),n(et,{modelValue:l.value,"onUpdate:modelValue":m[4]||(m[4]=r=>l.value=r),width:"1000px"},{default:v(()=>[n(re,{style:{"min-height":"700px"}},{default:v(()=>[n(Ce,{class:"d-flex"},{default:v(()=>[T(" Heatmap wizard "),n(Oe),x("div",ds,[n(H,{icon:"mdi-close",variant:"plain",size:"small",density:"compact",onClick:m[3]||(m[3]=r=>l.value=!1)})])]),_:1}),x("div",null,[S(t).activeAssayStatus?(R(),j(S(vl),{key:0,loading:!S(t).analysisCompleted(S(t).activeAssayStatus.assay.id),assays:S(t).assayStatuses},null,8,["loading","assays"])):(R(),te("div",ms,[x("div",vs,[n(qe,{indeterminate:"",color:"primary"})])]))])]),_:1})]),_:1},8,["modelValue"])]),_:1}))}}),ps=ce({__name:"PeptideExportButton",props:{assayStatus:{},buttonText:{}},setup(e){const t=e,a=I(!1),{downloadString:l}=Zt(),o=(i,s=",",u=";")=>{if(!t.assayStatus.analysisInProgress){a.value=!0;const d=pl.exportAsCsv(t.assayStatus.data.peptideCountTable,t.assayStatus.pept2Data,t.assayStatus.goOntology,t.assayStatus.ecOntology,t.assayStatus.interproOntology,t.assayStatus.ncbiOntology,s,u);l(d,`${t.assayStatus.assay.name}_mpa.csv`),new St().logDownloadMpa(i),a.value=!1}};return(i,s)=>(R(),j(yt,null,{activator:v(({props:u})=>[n(ee,{text:"Download a CSV-file with the results of this analysis."},{activator:v(({props:d})=>[n(H,U({"min-width":"187",disabled:i.assayStatus.analysisInProgress||a.value},U(u,d),{color:"default",loading:a.value,"prepend-icon":"mdi-download","append-icon":"mdi-menu-down"}),{default:v(()=>[T(X(i.buttonText),1)]),_:2},1040,["disabled","loading"])]),_:2},1024)]),default:v(()=>[n(Ee,null,{default:v(()=>[n(pe,{title:"Comma-separated (international)",onClick:s[0]||(s[0]=u=>o("csv (,)"))}),n(pe,{title:"Semi-colon-separated (Europe)",onClick:s[1]||(s[1]=u=>{o("csv (;)",";",",")})}),n(pe,{title:"Tab-separated",onClick:s[2]||(s[2]=u=>{o("tsv","	",";")})})]),_:1})]),_:1}))}});const gs=z({page:{type:[Number,String],default:1},itemsPerPage:{type:[Number,String],default:10}},"DataTable-paginate"),ca=Symbol.for("vuetify:data-table-pagination");function ys(e){const t=ge(e,"page",void 0,l=>+(l??1)),a=ge(e,"itemsPerPage",void 0,l=>+(l??10));return{page:t,itemsPerPage:a}}function hs(e){const{page:t,itemsPerPage:a,itemsLength:l}=e,o=D(()=>a.value===-1?0:a.value*(t.value-1)),i=D(()=>a.value===-1?l.value:Math.min(l.value,o.value+a.value)),s=D(()=>a.value===-1||l.value===0?1:Math.ceil(l.value/a.value));Xe(()=>{t.value>s.value&&(t.value=s.value)});function u(c){a.value=c,t.value=1}function d(){t.value=Re(t.value+1,1,s.value)}function f(){t.value=Re(t.value-1,1,s.value)}function m(c){t.value=Re(c,1,s.value)}const r={page:t,itemsPerPage:a,startIndex:o,stopIndex:i,pageCount:s,itemsLength:l,nextPage:d,prevPage:f,setPage:m,setItemsPerPage:u};return Ae(ca,r),r}function bs(){const e=Te(ca);if(!e)throw new Error("Missing pagination!");return e}function _s(e){const{items:t,startIndex:a,stopIndex:l,itemsPerPage:o}=e;return{paginatedItems:D(()=>o.value<=0?t.value:t.value.slice(a.value,l.value))}}const da=z({prevIcon:{type:String,default:"$prev"},nextIcon:{type:String,default:"$next"},firstIcon:{type:String,default:"$first"},lastIcon:{type:String,default:"$last"},itemsPerPageText:{type:String,default:"$vuetify.dataFooter.itemsPerPageText"},pageText:{type:String,default:"$vuetify.dataFooter.pageText"},firstPageLabel:{type:String,default:"$vuetify.dataFooter.firstPage"},prevPageLabel:{type:String,default:"$vuetify.dataFooter.prevPage"},nextPageLabel:{type:String,default:"$vuetify.dataFooter.nextPage"},lastPageLabel:{type:String,default:"$vuetify.dataFooter.lastPage"},itemsPerPageOptions:{type:Array,default:()=>[{value:10,title:"10"},{value:25,title:"25"},{value:50,title:"50"},{value:100,title:"100"},{value:-1,title:"$vuetify.dataFooter.itemsPerPageAll"}]},showCurrentPage:Boolean},"VDataTableFooter"),Ut=oe()({name:"VDataTableFooter",props:da(),setup(e,t){let{slots:a}=t;const{t:l}=Ue(),{page:o,pageCount:i,startIndex:s,stopIndex:u,itemsLength:d,itemsPerPage:f,setItemsPerPage:m}=bs(),r=D(()=>e.itemsPerPageOptions.map(c=>({...c,title:l(c.title)})));return()=>{var c;return n("div",{class:"v-data-table-footer"},[(c=a.prepend)==null?void 0:c.call(a),n("div",{class:"v-data-table-footer__items-per-page"},[n("span",null,[l(e.itemsPerPageText)]),n(sa,{items:r.value,modelValue:f.value,"onUpdate:modelValue":p=>m(Number(p)),density:"compact",variant:"outlined","hide-details":!0},null)]),n("div",{class:"v-data-table-footer__info"},[n("div",null,[l(e.pageText,d.value?s.value+1:0,u.value,d.value)])]),n("div",{class:"v-data-table-footer__pagination"},[n(H,{icon:e.firstIcon,variant:"plain",onClick:()=>o.value=1,disabled:o.value===1,"aria-label":l(e.firstPageLabel)},null),n(H,{icon:e.prevIcon,variant:"plain",onClick:()=>o.value=Math.max(1,o.value-1),disabled:o.value===1,"aria-label":l(e.prevPageLabel)},null),e.showCurrentPage&&n("span",{key:"page",class:"v-data-table-footer__page"},[o.value]),n(H,{icon:e.nextIcon,variant:"plain",onClick:()=>o.value=Math.min(i.value,o.value+1),disabled:o.value===i.value,"aria-label":l(e.nextPageLabel)},null),n(H,{icon:e.lastIcon,variant:"plain",onClick:()=>o.value=i.value,disabled:o.value===i.value,"aria-label":l(e.lastPageLabel)},null)])])}}}),wt=gl({align:{type:String,default:"start"},fixed:Boolean,fixedOffset:[Number,String],height:[Number,String],lastFixed:Boolean,noPadding:Boolean,tag:String,width:[Number,String]},(e,t)=>{let{slots:a,attrs:l}=t;const o=e.tag??"td";return n(o,U({class:["v-data-table__td",{"v-data-table-column--fixed":e.fixed,"v-data-table-column--last-fixed":e.lastFixed,"v-data-table-column--no-padding":e.noPadding},`v-data-table-column--align-${e.align}`],style:{height:ve(e.height),width:ve(e.width),left:ve(e.fixedOffset||null)}},l),{default:()=>{var i;return[(i=a.default)==null?void 0:i.call(a)]}})}),Ss=z({headers:{type:Array,default:()=>[]}},"DataTable-header"),ma=Symbol.for("vuetify:data-table-headers");function ws(e,t){const a=I([]),l=I([]);Xe(()=>{var p,g,P;const i=e.headers.length?Array.isArray(e.headers[0])?e.headers:[e.headers]:[],s=i.flatMap((y,V)=>y.map($=>({column:$,row:V}))),u=i.length,d={title:"",sortable:!1},f={...d,width:48};if((p=t==null?void 0:t.groupBy)!=null&&p.value.length){const y=s.findIndex(V=>{let{column:$}=V;return $.key==="data-table-group"});y<0?s.unshift({column:{...d,key:"data-table-group",title:"Group",rowspan:u},row:0}):s.splice(y,1,{column:{...d,...s[y].column},row:s[y].row})}if((g=t==null?void 0:t.showSelect)!=null&&g.value){const y=s.findIndex(V=>{let{column:$}=V;return $.key==="data-table-select"});y<0?s.unshift({column:{...f,key:"data-table-select",rowspan:u},row:0}):s.splice(y,1,{column:{...f,...s[y].column},row:s[y].row})}if((P=t==null?void 0:t.showExpand)!=null&&P.value){const y=s.findIndex(V=>{let{column:$}=V;return $.key==="data-table-expand"});y<0?s.push({column:{...f,key:"data-table-expand",rowspan:u},row:0}):s.splice(y,1,{column:{...f,...s[y].column},row:s[y].row})}const m=lt(u).map(()=>[]),r=lt(u).fill(0);s.forEach(y=>{let{column:V,row:$}=y,A=V.key;A==null&&(A="");for(let b=$;b<=$+(V.rowspan??1)-1;b++)m[b].push({...V,key:A,fixedOffset:r[b],sortable:V.sortable??!!V.key}),r[b]+=Number(V.width??0)}),m.forEach(y=>{for(let V=y.length;V--;V>=0)if(y[V].fixed){y[V].lastFixed=!0;return}});const c=new Set;a.value=m.map(y=>{const V=[];for(const $ of y)c.has($.key)||(c.add($.key),V.push($));return V}),l.value=m.at(-1)??[]});const o={headers:a,columns:l};return Ae(ma,o),o}function tt(){const e=Te(ma);if(!e)throw new Error("Missing headers!");return e}const Ps={showSelectAll:!1,allSelected:()=>[],select:e=>{var l;let{items:t,value:a}=e;return new Set(a?[(l=t[0])==null?void 0:l.value]:[])},selectAll:e=>{let{selected:t}=e;return t}},va={showSelectAll:!0,allSelected:e=>{let{currentPage:t}=e;return t},select:e=>{let{items:t,value:a,selected:l}=e;for(const o of t)a?l.add(o.value):l.delete(o.value);return l},selectAll:e=>{let{value:t,currentPage:a,selected:l}=e;return va.select({items:a,value:t,selected:l})}},fa={showSelectAll:!0,allSelected:e=>{let{allItems:t}=e;return t},select:e=>{let{items:t,value:a,selected:l}=e;for(const o of t)a?l.add(o.value):l.delete(o.value);return l},selectAll:e=>{let{value:t,allItems:a,selected:l}=e;return fa.select({items:a,value:t,selected:l})}},Vs=z({showSelect:Boolean,selectStrategy:{type:[String,Object],default:"page"},modelValue:{type:Array,default:()=>[]}},"DataTable-select"),pa=Symbol.for("vuetify:data-table-selection");function xs(e,t){let{allItems:a,currentPage:l}=t;const o=ge(e,"modelValue",e.modelValue,y=>new Set(y),y=>[...y.values()]),i=D(()=>a.value.filter(y=>y.selectable)),s=D(()=>l.value.filter(y=>y.selectable)),u=D(()=>{if(typeof e.selectStrategy=="object")return e.selectStrategy;switch(e.selectStrategy){case"single":return Ps;case"all":return fa;case"page":default:return va}});function d(y){return Ke(y).every(V=>o.value.has(V.value))}function f(y){return Ke(y).some(V=>o.value.has(V.value))}function m(y,V){const $=u.value.select({items:y,value:V,selected:new Set(o.value)});o.value=$}function r(y){m([y],!d([y]))}function c(y){const V=u.value.selectAll({value:y,allItems:i.value,currentPage:s.value,selected:new Set(o.value)});o.value=V}const p=D(()=>o.value.size>0),g=D(()=>{const y=u.value.allSelected({allItems:i.value,currentPage:s.value});return d(y)}),P={toggleSelect:r,select:m,selectAll:c,isSelected:d,isSomeSelected:f,someSelected:p,allSelected:g,showSelectAll:u.value.showSelectAll};return Ae(pa,P),P}function at(){const e=Te(pa);if(!e)throw new Error("Missing selection!");return e}const ks=z({sortBy:{type:Array,default:()=>[]},customKeySort:Object,multiSort:Boolean,mustSort:Boolean},"DataTable-sort"),ga=Symbol.for("vuetify:data-table-sort");function Cs(e){const t=ge(e,"sortBy"),a=fe(e,"mustSort"),l=fe(e,"multiSort");return{sortBy:t,mustSort:a,multiSort:l}}function As(e){const{sortBy:t,mustSort:a,multiSort:l,page:o}=e,i=d=>{let f=t.value.map(r=>({...r}))??[];const m=f.find(r=>r.key===d.key);m?m.order==="desc"?a.value?m.order="asc":f=f.filter(r=>r.key!==d.key):m.order="desc":l.value?f=[...f,{key:d.key,order:"asc"}]:f=[{key:d.key,order:"asc"}],t.value=f,o&&(o.value=1)};function s(d){return!!t.value.find(f=>f.key===d.key)}const u={sortBy:t,toggleSort:i,isSorted:s};return Ae(ga,u),u}function Ts(){const e=Te(ga);if(!e)throw new Error("Missing sort!");return e}function Is(e,t,a){const l=Ue();return{sortedItems:D(()=>a.value.length?Ds(t.value,a.value,l.current.value,e.customKeySort):t.value)}}function Ds(e,t,a,l){const o=new Intl.Collator(a,{sensitivity:"accent",usage:"sort"});return[...e].sort((i,s)=>{for(let u=0;u<t.length;u++){const d=t[u].key,f=t[u].order??"asc";if(f===!1)continue;let m=ot(i.raw,d),r=ot(s.raw,d);if(f==="desc"&&([m,r]=[r,m]),l!=null&&l[d]){const c=l[d](m,r);if(!c)continue;return c}if(m instanceof Date&&r instanceof Date)return m.getTime()-r.getTime();if([m,r]=[m,r].map(c=>c!=null?c.toString().toLocaleLowerCase():c),m!==r)return Ge(m)&&Ge(r)?0:Ge(m)?-1:Ge(r)?1:!isNaN(m)&&!isNaN(r)?Number(m)-Number(r):o.compare(m,r)}return 0})}const ya=z({color:String,sticky:Boolean,multiSort:Boolean,sortAscIcon:{type:Be,default:"$sortAsc"},sortDescIcon:{type:Be,default:"$sortDesc"},...yl()},"VDataTableHeaders"),Ht=oe()({name:"VDataTableHeaders",props:ya(),setup(e,t){let{slots:a,emit:l}=t;const{toggleSort:o,sortBy:i,isSorted:s}=Ts(),{someSelected:u,allSelected:d,selectAll:f,showSelectAll:m}=at(),{columns:r,headers:c}=tt(),{loaderClasses:p}=hl(e),g=(b,h)=>{if(!(!e.sticky&&!b.fixed))return{position:"sticky",zIndex:b.fixed?4:e.sticky?3:void 0,left:b.fixed?ve(b.fixedOffset):void 0,top:e.sticky?`calc(var(--v-table-header-height) * ${h})`:void 0}};function P(b){const h=i.value.find(E=>E.key===b.key);return h?h.order==="asc"?e.sortAscIcon:e.sortDescIcon:e.sortAscIcon}const{backgroundColorClasses:y,backgroundColorStyles:V}=bl(e,"color"),$=D(()=>({headers:c.value,columns:r.value,toggleSort:o,isSorted:s,sortBy:i.value,someSelected:u.value,allSelected:d.value,selectAll:f,getSortIcon:P,getFixedStyles:g})),A=b=>{let{column:h,x:E,y:_}=b;const k=h.key==="data-table-select"||h.key==="data-table-expand";return n(wt,{tag:"th",align:h.align,class:["v-data-table__th",{"v-data-table__th--sortable":h.sortable,"v-data-table__th--sorted":s(h)},p.value],style:{width:ve(h.width),minWidth:ve(h.width),...g(h,_)},colspan:h.colspan,rowspan:h.rowspan,onClick:h.sortable?()=>o(h):void 0,lastFixed:h.lastFixed,noPadding:k},{default:()=>{var N;const w=`column.${h.key}`,M={column:h,selectAll:f,isSorted:s,toggleSort:o,sortBy:i.value,someSelected:u.value,allSelected:d.value,getSortIcon:P};return a[w]?a[w](M):h.key==="data-table-select"?((N=a["column.data-table-select"])==null?void 0:N.call(a,M))??(m&&n(Je,{modelValue:d.value,indeterminate:u.value&&!d.value,"onUpdate:modelValue":f},null)):n("div",{class:"v-data-table-header__content"},[n("span",null,[h.title]),h.sortable&&n(ke,{key:"icon",class:"v-data-table-header__sort-icon",icon:P(h)},null),e.multiSort&&s(h)&&n("div",{key:"badge",class:["v-data-table-header__sort-badge",...y.value],style:V.value},[i.value.findIndex(O=>O.key===h.key)+1])])}})};ue(()=>n(ae,null,[a.headers?a.headers($.value):c.value.map((b,h)=>n("tr",null,[b.map((E,_)=>n(A,{column:E,x:_,y:h},null))])),e.loading&&n("tr",{class:"v-data-table-progress"},[n("th",{colspan:r.value.length},[n(_l,{name:"v-data-table-progress",active:!0,color:typeof e.loading=="boolean"?void 0:e.loading,indeterminate:!0},{default:a.loader})])])]))}}),$s=z({groupBy:{type:Array,default:()=>[]}},"DataTable-group"),ha=Symbol.for("vuetify:data-table-group");function Os(e){return{groupBy:ge(e,"groupBy")}}function Es(e){const{groupBy:t,sortBy:a}=e,l=I(new Set),o=D(()=>t.value.map(f=>({...f,order:f.order??!1})).concat(a.value));function i(f){return l.value.has(f.id)}function s(f){const m=new Set(l.value);i(f)?m.delete(f.id):m.add(f.id),l.value=m}function u(f){function m(r){const c=[];for(const p of r.items)"type"in p&&p.type==="group"?c.push(...m(p)):c.push(p);return c}return m({type:"group",items:f,id:"dummy",key:"dummy",value:"dummy",depth:0})}const d={sortByWithGroups:o,toggleGroup:s,opened:l,groupBy:t,extractRows:u,isGroupOpen:i};return Ae(ha,d),d}function ba(){const e=Te(ha);if(!e)throw new Error("Missing group!");return e}function Rs(e,t){if(!e.length)return[];const a=new Map;for(const l of e){const o=ot(l.raw,t);a.has(o)||a.set(o,[]),a.get(o).push(l)}return a}function _a(e,t){let a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,l=arguments.length>3&&arguments[3]!==void 0?arguments[3]:"root";if(!t.length)return[];const o=Rs(e,t[0]),i=[],s=t.slice(1);return o.forEach((u,d)=>{const f=t[0],m=`${l}_${f}_${d}`;i.push({depth:a,id:m,key:f,value:d,items:s.length?_a(u,s,a+1,m):u,type:"group"})}),i}function Sa(e,t){const a=[];for(const l of e)"type"in l&&l.type==="group"?(l.value!=null&&a.push(l),(t.has(l.id)||l.value==null)&&a.push(...Sa(l.items,t))):a.push(l);return a}function Bs(e,t,a){return{flatItems:D(()=>{if(!t.value.length)return e.value;const o=_a(e.value,t.value.map(i=>i.key));return Sa(o,a.value)})}}const Ls=z({item:{type:Object,required:!0}},"VDataTableGroupHeaderRow"),Ms=oe()({name:"VDataTableGroupHeaderRow",props:Ls(),setup(e,t){let{slots:a}=t;const{isGroupOpen:l,toggleGroup:o,extractRows:i}=ba(),{isSelected:s,isSomeSelected:u,select:d}=at(),{columns:f}=tt(),m=D(()=>i([e.item]));return()=>n("tr",{class:"v-data-table-group-header-row",style:{"--v-data-table-group-header-row-depth":e.item.depth}},[f.value.map(r=>{var c,p;if(r.key==="data-table-group"){const g=l(e.item)?"$expand":"$next",P=()=>o(e.item);return((c=a["data-table-group"])==null?void 0:c.call(a,{item:e.item,count:m.value.length,props:{icon:g,onClick:P}}))??n(wt,{class:"v-data-table-group-header-row__column"},{default:()=>[n(H,{size:"small",variant:"text",icon:g,onClick:P},null),n("span",null,[e.item.value]),n("span",null,[T("("),m.value.length,T(")")])]})}if(r.key==="data-table-select"){const g=s(m.value),P=u(m.value)&&!g,y=V=>d(m.value,V);return((p=a["data-table-select"])==null?void 0:p.call(a,{props:{modelValue:g,indeterminate:P,"onUpdate:modelValue":y}}))??n("td",null,[n(Je,{modelValue:g,indeterminate:P,"onUpdate:modelValue":y},null)])}return n("td",null,null)})])}}),Fs=z({expandOnClick:Boolean,showExpand:Boolean,expanded:{type:Array,default:()=>[]}},"DataTable-expand"),wa=Symbol.for("vuetify:datatable:expanded");function Us(e){const t=fe(e,"expandOnClick"),a=ge(e,"expanded",e.expanded,u=>new Set(u),u=>[...u.values()]);function l(u,d){const f=new Set(a.value);d?f.add(u.value):f.delete(u.value),a.value=f}function o(u){return a.value.has(u.value)}function i(u){l(u,!o(u))}const s={expand:l,expanded:a,expandOnClick:t,isExpanded:o,toggleExpand:i};return Ae(wa,s),s}function Pa(){const e=Te(wa);if(!e)throw new Error("foo");return e}const Hs=z({index:Number,item:Object,onClick:Function},"VDataTableRow"),js=Sl({name:"VDataTableRow",props:Hs(),setup(e,t){let{slots:a}=t;const{isSelected:l,toggleSelect:o}=at(),{isExpanded:i,toggleExpand:s}=Pa(),{columns:u}=tt();ue(()=>n("tr",{class:["v-data-table__tr",{"v-data-table__tr--clickable":!!e.onClick}],onClick:e.onClick},[e.item&&u.value.map((d,f)=>n(wt,{align:d.align,fixed:d.fixed,fixedOffset:d.fixedOffset,lastFixed:d.lastFixed,noPadding:d.key==="data-table-select"||d.key==="data-table-expand",width:d.width},{default:()=>{var p,g;const m=e.item,r=`item.${d.key}`,c={index:e.index,item:e.item,columns:u.value,isSelected:l,toggleSelect:o,isExpanded:i,toggleExpand:s};return a[r]?a[r](c):d.key==="data-table-select"?((p=a["item.data-table-select"])==null?void 0:p.call(a,c))??n(Je,{disabled:!m.selectable,modelValue:l([m]),onClick:st(()=>o(m),["stop"])},null):d.key==="data-table-expand"?((g=a["item.data-table-expand"])==null?void 0:g.call(a,c))??n(H,{icon:i(m)?"$collapse":"$expand",size:"small",variant:"text",onClick:st(()=>s(m),["stop"])},null):_e(m.columns,d.key)}}))]))}}),Va=z({loading:[Boolean,String],loadingText:{type:String,default:"$vuetify.dataIterator.loadingText"},hideNoData:Boolean,items:{type:Array,default:()=>[]},noDataText:{type:String,default:"$vuetify.noDataText"},rowHeight:Number,"onClick:row":Function},"VDataTableRows"),jt=oe()({name:"VDataTableRows",props:Va(),setup(e,t){let{emit:a,slots:l}=t;const{columns:o}=tt(),{expandOnClick:i,toggleExpand:s,isExpanded:u}=Pa(),{isSelected:d,toggleSelect:f}=at(),{toggleGroup:m,isGroupOpen:r}=ba(),{t:c}=Ue();return ue(()=>{var p;return e.loading&&l.loading?n("tr",{class:"v-data-table-rows-loading",key:"loading"},[n("td",{colspan:o.value.length},[l.loading()])]):!e.loading&&!e.items.length&&!e.hideNoData?n("tr",{class:"v-data-table-rows-no-data",key:"no-data"},[n("td",{colspan:o.value.length},[((p=l["no-data"])==null?void 0:p.call(l))??c(e.noDataText)])]):n(ae,null,[e.items.map((g,P)=>{var $;if(g.type==="group")return l["group-header"]?l["group-header"]({index:P,item:g,columns:o.value,isExpanded:u,toggleExpand:s,isSelected:d,toggleSelect:f,toggleGroup:m,isGroupOpen:r}):n(Ms,{key:`group-header_${g.id}`,item:g},l);const y={index:P,item:g,columns:o.value,isExpanded:u,toggleExpand:s,isSelected:d,toggleSelect:f},V={...y,props:{key:`item_${g.key??g.index}`,onClick:i.value||e["onClick:row"]?A=>{var b;i.value&&s(g),(b=e["onClick:row"])==null||b.call(e,A,{item:g})}:void 0,index:P,item:g}};return n(ae,null,[l.item?l.item(V):n(js,V.props,l),u(g)&&(($=l["expanded-row"])==null?void 0:$.call(l,y))])})])}),{}}}),Ns=z({items:{type:Array,default:()=>[]},itemValue:{type:[String,Array,Function],default:"id"},itemSelectable:{type:[String,Array,Function],default:null},returnObject:Boolean},"DataTable-items");function Gs(e,t,a,l){const o=e.returnObject?t:_e(t,e.itemValue),i=_e(t,e.itemSelectable,!0),s=l.reduce((u,d)=>(u[d.key]=_e(t,d.value??d.key),u),{});return{type:"item",key:e.returnObject?_e(t,e.itemValue):o,index:a,value:o,selectable:i,columns:s,raw:t}}function zs(e,t,a){return t.map((l,o)=>Gs(e,l,o,a))}function Ks(e,t){return{items:D(()=>zs(e,e.items,t.value))}}function qs(e){let{page:t,itemsPerPage:a,sortBy:l,groupBy:o,search:i}=e;const s=Gt("VDataTable"),u=D(()=>({page:t.value,itemsPerPage:a.value,sortBy:l.value,groupBy:o.value,search:i.value}));se(()=>i==null?void 0:i.value,()=>{t.value=1});let d=null;se(u,()=>{zt(d,u.value)||(s.emit("update:options",u.value),d=u.value)},{deep:!0,immediate:!0})}const Ws=z({...Va(),width:[String,Number],search:String,...Fs(),...$s(),...Ss(),...Ns(),...Vs(),...ks(),...ya(),...Kl()},"DataTable"),Ys=z({...gs(),...Ws(),...ln(),...da()},"VDataTable"),Xs=oe()({name:"VDataTable",props:Ys(),emits:{"update:modelValue":e=>!0,"update:page":e=>!0,"update:itemsPerPage":e=>!0,"update:sortBy":e=>!0,"update:options":e=>!0,"update:groupBy":e=>!0,"update:expanded":e=>!0},setup(e,t){let{emit:a,slots:l}=t;const{groupBy:o}=Os(e),{sortBy:i,multiSort:s,mustSort:u}=Cs(e),{page:d,itemsPerPage:f}=ys(e),{columns:m,headers:r}=ws(e,{groupBy:o,showSelect:fe(e,"showSelect"),showExpand:fe(e,"showExpand")}),{items:c}=Ks(e,m),p=fe(e,"search"),{filteredItems:g}=sn(e,c,p,{transform:K=>K.columns}),{toggleSort:P}=As({sortBy:i,multiSort:s,mustSort:u,page:d}),{sortByWithGroups:y,opened:V,extractRows:$,isGroupOpen:A,toggleGroup:b}=Es({groupBy:o,sortBy:i}),{sortedItems:h}=Is(e,g,y),{flatItems:E}=Bs(h,o,V),_=D(()=>E.value.length),{startIndex:k,stopIndex:w,pageCount:M,setItemsPerPage:N}=hs({page:d,itemsPerPage:f,itemsLength:_}),{paginatedItems:O}=_s({items:E,startIndex:k,stopIndex:w,itemsPerPage:f}),G=D(()=>$(O.value)),{isSelected:W,select:le,selectAll:C,toggleSelect:B,someSelected:q,allSelected:Y}=xs(e,{allItems:c,currentPage:G}),{isExpanded:J,toggleExpand:L}=Us(e);qs({page:d,itemsPerPage:f,sortBy:i,groupBy:o,search:p}),wl({VDataTableRows:{hideNoData:fe(e,"hideNoData"),noDataText:fe(e,"noDataText"),loading:fe(e,"loading"),loadingText:fe(e,"loadingText")}});const F=D(()=>({page:d.value,itemsPerPage:f.value,sortBy:i.value,pageCount:M.value,toggleSort:P,setItemsPerPage:N,someSelected:q.value,allSelected:Y.value,isSelected:W,select:le,selectAll:C,toggleSelect:B,isExpanded:J,toggleExpand:L,isGroupOpen:A,toggleGroup:b,items:G.value,groupedItems:O.value,columns:m.value,headers:r.value}));return ue(()=>{const[K]=Ut.filterProps(e),[de]=Ht.filterProps(e),[ne]=jt.filterProps(e),[Q]=Ot.filterProps(e);return n(Ot,U({class:["v-data-table",{"v-data-table--show-select":e.showSelect,"v-data-table--loading":e.loading},e.class],style:e.style},Q),{top:()=>{var ye;return(ye=l.top)==null?void 0:ye.call(l,F.value)},default:()=>{var ye,he,we,De;return l.default?l.default(F.value):n(ae,null,[(ye=l.colgroup)==null?void 0:ye.call(l,F.value),n("thead",null,[n(Ht,de,l)]),(he=l.thead)==null?void 0:he.call(l,F.value),n("tbody",null,[l.body?l.body(F.value):n(jt,U(ne,{items:O.value}),l)]),(we=l.tbody)==null?void 0:we.call(l,F.value),(De=l.tfoot)==null?void 0:De.call(l,F.value)])},bottom:()=>l.bottom?l.bottom(F.value):n(ae,null,[n(Ut,K,{prepend:l["footer.prepend"]})])})}),{}}}),Qs=ce({__name:"MissingPeptidesTable",props:{items:{}},setup(e){const t=e,a=I([{title:"Peptide",align:"start",key:"peptide",width:"90%",sortable:!0},{title:"Actions",align:"center",key:"action",width:"10%",sortable:!1}]),l=D(()=>t.items.map(s=>({peptide:s}))),o=function(s){window.open(i(s),"_blank")},i=s=>"http://blast.ncbi.nlm.nih.gov/Blast.cgi?PAGE_TYPE=BlastSearch&SET_SAVED_SEARCH=on&USER_FORMAT_DEFAULTS=on&PAGE=Proteins&PROGRAM=blastp&QUERY="+s+"&GAPCOSTS=11%201&EQ_MENU=Enter%20organism%20name%20or%20id--completions%20will%20be%20suggested&DATABASE=nr&BLAST_PROGRAMS=blastp&MAX_NUM_SEQ=100&SHORT_QUERY_ADJUST=on&EXPECT=10&WORD_SIZE=3&MATRIX_NAME=BLOSUM62&COMPOSITION_BASED_STATISTICS=2&SHOW_OVERVIEW=on&SHOW_LINKOUT=on&ALIGNMENT_VIEW=Pairwise&MASK_CHAR=2&MASK_COLOR=1&GET_SEQUENCE=on&NEW_VIEW=on&NUM_OVERVIEW=100&DESCRIPTIONS=100&ALIGNMENTS=100&FORMAT_OBJECT=Alignment&FORMAT_TYPE=HTML&OLD_BLAST=false";return(s,u)=>(R(),te("div",null,[n(S(Xs),{headers:a.value,loading:!s.items,items:l.value,"items-per-page":10},{"item.peptide":v(({item:d})=>[x("span",null,X(d.raw.peptide),1)]),"item.action":v(({item:d})=>[n(ee,{text:"Open in new tab and BLAST peptide."},{activator:v(({props:f})=>[n(H,U({icon:"mdi-open-in-new",size:"small",variant:"plain"},f,{onClick:m=>o(d.raw.peptide)}),null,16,["onClick"])]),_:2},1024)]),_:1},8,["headers","loading","items"])]))}});const Js=Ze(Qs,[["__scopeId","data-v-fa17f4c9"]]),Zs={class:"justify-end"},eo={class:"d-flex justify-center mt-3"},to=ce({__name:"MissingPeptidesDialog",props:{modelValue:{type:Boolean},missedPeptides:{}},emits:["update:modelValue"],setup(e,{emit:t}){const a=e,l=I(a.modelValue);se(l,i=>{t("update:modelValue",i)}),se(()=>a.modelValue,i=>{l.value=i});const o=()=>{navigator.clipboard.writeText(a.missedPeptides.join(`
`))};return(i,s)=>(R(),j(et,{modelValue:l.value,"onUpdate:modelValue":s[1]||(s[1]=u=>l.value=u),scrollable:"",width:600},{default:v(()=>[n(re,null,{default:v(()=>[n(Ce,{class:"d-flex"},{default:v(()=>[T(X(i.missedPeptides.length)+" missed peptides ",1),n(Oe),x("div",Zs,[n(H,{icon:"mdi-close",variant:"plain",size:"small",density:"compact",onClick:s[0]||(s[0]=u=>l.value=!1)})])]),_:1}),n(ie,null,{default:v(()=>[x("p",null,[T(" Sorry, we didn't manage to find "),x("b",null,X(i.missedPeptides.length),1),T(" of your peptides. You can BLAST them by clicking the links or copy them by using the button below. ")]),n(Js,{items:i.missedPeptides},null,8,["items"]),x("div",eo,[n(H,{color:"primary","prepend-icon":"mdi-content-copy",onClick:o},{default:v(()=>[T(" Copy all to clipboard ")]),_:1})])]),_:1})]),_:1})]),_:1},8,["modelValue"]))}}),je=e=>(dt("data-v-3a286d6e"),e=e(),mt(),e),ao={key:0},lo={key:1,class:"d-flex loading-container"},no={class:"flex-grow-1"},so=je(()=>x("div",null," An error occurred during the analysis of this assay. ",-1)),oo=je(()=>x("div",{class:"font-weight-bold mt-2"}," Error details: ",-1)),io={key:0},ro=je(()=>x("div",{class:"font-weight-bold mt-2"}," Stack trace: ",-1)),uo={key:3,class:"dark-label"},co=je(()=>x("h3",{class:"mb-2"}," Peptide list ",-1)),mo=je(()=>x("h3",{class:"mn-2"}," Search settings ",-1)),vo={class:"card-actions d-flex flex-wrap justify-center"},fo={key:0},po={class:"peptide-match-text"},go=ce({__name:"AnalysisSummaryCard",setup(e){const t=Se(),{activeAssayStatus:a}=vt(t),l=D(()=>{var g;return((g=t.activeAssayStatus)==null?void 0:g.equateIl)||!0}),o=D(()=>{var g;return((g=t.activeAssayStatus)==null?void 0:g.filterDuplicates)||!0}),i=D(()=>{var g;return((g=t.activeAssayStatus)==null?void 0:g.cleavageHandling)||!1}),s=I(l.value),u=I(o.value),d=I(i.value),f=I(!1),m=I(!1),r=D(()=>t.activeAssayStatus?t.activeAssayStatus.assay.peptides.join(`
`):"");se(()=>t.activeAssayStatus,()=>{s.value=l.value,u.value=o.value,d.value=i.value});const c=()=>s.value!==l.value||u.value!==o.value||d.value!==i.value,p=()=>{if(c()&&t.activeAssayStatus){const g=t.activeAssayStatus.assay;new St().logSearchMpa(g.amountOfPeptides,s.value,u.value,d.value,!0),t.resetAssay(g),t.analyse(g,s.value,u.value,d.value)}};return t.$subscribe((g,P)=>{var y;f.value=((y=P.activeAssayStatus)==null?void 0:y.analysisInProgress)||!0}),(g,P)=>(R(),j(re,{class:"d-flex flex-column flex-grow-1"},{default:v(()=>[n(Ce,{class:"bg-primary text-white"},{default:v(()=>[T(" Analysis summary ")]),_:1}),n(ie,{class:"mt-4 d-flex flex-column flex-grow-1"},{default:v(()=>[S(a)?S(a).analysisInProgress?(R(),te("div",lo,[n(qe,{indeterminate:"",color:"primary"})])):S(a).error.status?(R(),j(Fe,{key:2,type:"error",class:"flex-grow-0"},{default:v(()=>[x("div",no,[so,oo,x("div",null,X(S(a).error.message),1),S(a).error.object&&S(a).error.object.stack?(R(),te("div",io,[ro,x("div",null,X(S(a).error.object.stack),1)])):Le("",!0)])]),_:1})):(R(),te("div",uo,[co,n(pt,{modelValue:r.value,"onUpdate:modelValue":P[0]||(P[0]=y=>r.value=y),readonly:!0},null,8,["modelValue"]),mo,n(ee,{text:"Equate isoleucine (I) and leucine (L) when matching peptides to UniProt entries"},{activator:v(({props:y})=>[n($e,U({modelValue:s.value,"onUpdate:modelValue":P[1]||(P[1]=V=>s.value=V),class:"pt-0 mt-0",density:"compact","hide-details":"",color:"primary",label:"Equate I and L"},y,{inset:""}),null,16,["modelValue"])]),_:1}),n(ee,{text:"Remove duplicate peptides from the input before searching."},{activator:v(({props:y})=>[n($e,U({modelValue:u.value,"onUpdate:modelValue":P[2]||(P[2]=V=>u.value=V),class:"pt-0 mt-0",density:"compact","hide-details":"",color:"primary",label:"Filter duplicate peptides"},y,{inset:""}),null,16,["modelValue"])]),_:1}),n(ee,{text:"Recombine subpeptides of miscleavages. Enabling this has a serious performance impact!"},{activator:v(({props:y})=>[n($e,U({modelValue:d.value,"onUpdate:modelValue":P[3]||(P[3]=V=>d.value=V),class:"pt-0 mt-0",density:"compact","hide-details":"",color:"primary",label:"Advanced missed cleavage handling"},y,{inset:""}),null,16,["modelValue"])]),_:1}),x("div",vo,[n(ee,{text:"Restart search with selected samples using the settings chosen above."},{activator:v(({props:y})=>[n(H,U({class:"mr-3 mb-2",disabled:!c(),color:"primary"},y,{"prepend-icon":"mdi-restore",onClick:P[4]||(P[4]=V=>p())}),{default:v(()=>[T(" Update ")]),_:2},1040,["disabled"])]),_:1}),n(ps,{"assay-status":S(a),"button-text":"Download results"},null,8,["assay-status"])]),S(a).data?(R(),te("div",fo,[n(ht,{class:"my-3"}),x("span",po,[T(" We managed to match "+X(S(a).data.trust.matchedPeptides)+" of your "+X(S(a).data.trust.searchedPeptides)+" peptides. Unfortunately, ",1),x("a",{style:{cursor:"pointer"},class:"link",onClick:P[5]||(P[5]=y=>m.value=!0)},X(S(a).data.trust.missedPeptides.length),1),T(" peptides couldn't be found. ")]),n(to,{modelValue:m.value,"onUpdate:modelValue":P[6]||(P[6]=y=>m.value=y),"missed-peptides":S(a).data.trust.missedPeptides},null,8,["modelValue","missed-peptides"])])):Le("",!0)])):(R(),te("div",ao,[n(Fe,{type:"error"},{default:v(()=>[T(" There currently is no active assay. Please select one from the list on the left or add a new assay. ")]),_:1})]))]),_:1})]),_:1}))}});const yo=Ze(go,[["__scopeId","data-v-3a286d6e"]]),ho={class:"justify-end"},bo=x("p",null,"The functional annotations can be sorted on two metrics:",-1),_o=x("ul",null,[x("li",null,[x("strong",null,"Peptides"),T(": The absolute number of peptides that are associated with a given functional annotation. ")]),x("li",null,[x("strong",null,"Peptides%"),T(": Like peptides, but the reported value is represented as a percentage indicating the fraction of the total number of peptides. ")])],-1),So=x("p",null,[x("br"),T(' Your "Filter duplicate peptides" setting is taken into account. If it is enabled, peptides that occur multiple times in your input list are counted that many times. ')],-1),wo=ce({__name:"SortingPeptidesDialog",props:{modelValue:{type:Boolean}},emits:["update:modelValue"],setup(e,{emit:t}){const a=e,l=I(a.modelValue);return se(l,o=>{t("update:modelValue",o)}),se(()=>a.modelValue,o=>{l.value=o}),(o,i)=>(R(),j(et,{modelValue:l.value,"onUpdate:modelValue":i[2]||(i[2]=s=>l.value=s),"max-width":"600"},{default:v(()=>[n(re,null,{default:v(()=>[n(Ce,{class:"d-flex"},{default:v(()=>[T(" Sorting functional annotations "),n(Oe),x("div",ho,[n(H,{icon:"mdi-close",variant:"plain",size:"small",density:"compact",onClick:i[0]||(i[0]=s=>l.value=!1)})])]),_:1}),n(ie,null,{default:v(()=>[bo,_o,So]),_:1}),n(ea,null,{default:v(()=>[n(Oe),n(H,{color:"primary",variant:"elevated",onClick:i[1]||(i[1]=s=>l.value=!1)},{default:v(()=>[T(" I understand ")]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"]))}}),Ie=e=>(dt("data-v-f4fdcfb1"),e=e(),mt(),e),Po={class:"mt-5"},Vo={style:{width:"100%"}},xo=Ie(()=>x("span",{class:"font-weight-bold"},"Filtered results:",-1)),ko={class:"font-weight-bold"},Co=Ie(()=>x("h2",null,"Select samples",-1)),Ao=Ie(()=>x("p",null," Make a selection of samples that should be analysed. New samples can be added by pasting a peptide list, or existing samples can be reused. ",-1)),To=Ie(()=>x("h2",null,"Click search",-1)),Io=Ie(()=>x("p",null," Review the search settings for peptide deduplication, advanced missed cleavage handling and equating isoleucine and leucine before clicking search. ",-1)),Do=Ie(()=>x("h2",null,"Gain insight",-1)),$o=Ie(()=>x("p",null," For each of the peptides, the lowest common ancestor (LCA) will be calculated, aggregated and visualised on the result page, giving you insight in the taxonomic diversity of your sample. ",-1)),Oo=ce({__name:"MetaproteomeAnalysisPage",setup(e){const t=Se(),{activeAssayStatus:a}=vt(t),l=I(!0),o=I(!1),i=I(!1),s=I(0),u=I(!1),{downloadString:d}=Zt(),f=()=>{var A,b;return(A=t.activeAssayStatus)!=null&&A.filterId?((b=t.activeAssayStatus)==null?void 0:b.filterId)!==1:!1},m=()=>{if(t.activeAssayStatus)return t.activeAssayStatus.ncbiOntology.getDefinition(t.activeAssayStatus.filterId)},r=()=>{l.value=!1,o.value=!0},c=()=>{var A;if(t.activeAssayStatus&&t.analysisCompleted(t.activeAssayStatus.assay.id))return Al((A=t.activeAssayStatus.filteredData)==null?void 0:A.ecCountTableProcessor.getCountTable(),t.activeAssayStatus.ecOntology)},p=A=>{t.activeAssayStatus&&t.filterAssayByRank(t.activeAssayStatus.assay.id,A)},g=A=>{t.activeAssayStatus&&t.filterAssayByPercentage(t.activeAssayStatus.assay.id,A)};Pl(()=>{l.value=!0,t.removeAllAssays(),o.value=!1,i.value=!1});const P=async(A,b,h)=>{if(!a.value)return;const _=await new nt().getPeptideCountTable(A.getAnnotationPeptideMapping().get(h),a.value.cleavageHandling,a.value.filterDuplicates,a.value.equateIl),w=await new Il().summarizeFunctionalAnnotation(b.getDefinition(h),_,a.value.pept2Data,a.value.ncbiOntology,N=>N.ec),M=Tl.toCsvString(w);d(M,h.replace(/:/g,"_")+".csv")},y=async A=>{var b,h,E;P((h=(b=a.value)==null?void 0:b.filteredData)==null?void 0:h.ecCountTableProcessor,(E=a.value)==null?void 0:E.ecOntology,A)},V=async A=>{var b,h,E;P((h=(b=a.value)==null?void 0:b.filteredData)==null?void 0:h.goCountTableProcessor,(E=a.value)==null?void 0:E.goOntology,A)},$=async A=>{var b,h,E;P((h=(b=a.value)==null?void 0:b.filteredData)==null?void 0:h.interproCountTableProcessor,(E=a.value)==null?void 0:E.interproOntology,A)};return(A,b)=>(R(),te("div",Po,[n(be,null,{default:v(()=>[n(me,{sm:"6"},{default:v(()=>[l.value?(R(),j(ss,{key:0,style:{"min-height":"100%"},onSearch:r})):(R(),j(fs,{key:1,style:{"min-height":"100%"},"assay-selection-in-progress":!0}))]),_:1}),n(me,{sm:"6"},{default:v(()=>[o.value?(R(),j(yo,{key:1,style:{"min-height":"100%"}})):(R(),j(Qn,{key:0,style:{"min-height":"100%"}}))]),_:1})]),_:1}),S(t).activeAssayStatus?(R(),te(ae,{key:0},[n(be,null,{default:v(()=>[f()?(R(),j(me,{key:0,cols:"12"},{default:v(()=>[n(Fe,{class:"mb-0",type:"info",variant:"tonal"},{default:v(()=>{var h,E;return[x("div",Vo,[x("span",null,[xo,T(" these results are limited to the "+X(S(t).activeAssayStatus.filteredData.trust.matchedPeptides)+" peptides specific to ",1),x("span",ko,X((h=m())==null?void 0:h.name)+" ("+X((E=m())==null?void 0:E.rank)+")",1)]),n(H,{color:"primary",size:"small",class:"float-end",onClick:b[0]||(b[0]=_=>p(1))},{default:v(()=>[T(" Reset filter ")]),_:1})])]}),_:1})]),_:1})):Le("",!0)]),_:1}),n(be,null,{default:v(()=>[n(me,{cols:"12"},{default:v(()=>{var h,E,_,k,w,M,N,O,G,W,le,C,B,q,Y,J,L;return[n(S(Vl),{"analysis-in-progress":!S(t).analysisCompleted(S(t).activeAssayStatus.assay.id),"ec-tree":c(),"go-count-table-processor":(E=(h=S(t).activeAssayStatus)==null?void 0:h.filteredData)==null?void 0:E.goCountTableProcessor,"go-ontology":(_=S(t).activeAssayStatus)==null?void 0:_.goOntology,"ec-count-table-processor":(w=(k=S(t).activeAssayStatus)==null?void 0:k.filteredData)==null?void 0:w.ecCountTableProcessor,"ec-ontology":(M=S(t).activeAssayStatus)==null?void 0:M.ecOntology,"interpro-count-table-processor":(O=(N=S(t).activeAssayStatus)==null?void 0:N.filteredData)==null?void 0:O.interproCountTableProcessor,"interpro-ontology":(G=S(t).activeAssayStatus)==null?void 0:G.interproOntology,"ncbi-count-table-processor":(le=(W=S(t).activeAssayStatus)==null?void 0:W.data)==null?void 0:le.lcaCountTableProcessor,"ncbi-ontology":(C=S(t).activeAssayStatus)==null?void 0:C.ncbiOntology,"ncbi-tree":(q=(B=S(t).activeAssayStatus)==null?void 0:B.data)==null?void 0:q.tree,"filter-id":(Y=S(t).activeAssayStatus)==null?void 0:Y.filterId,error:(L=(J=S(a))==null?void 0:J.error)==null?void 0:L.status,onUpdateSelectedTaxonId:p},null,8,["analysis-in-progress","ec-tree","go-count-table-processor","go-ontology","ec-count-table-processor","ec-ontology","interpro-count-table-processor","interpro-ontology","ncbi-count-table-processor","ncbi-ontology","ncbi-tree","filter-id","error"])]}),_:1})]),_:1}),n(be,null,{default:v(()=>[n(me,{cols:"12"},{default:v(()=>[n(re,null,{default:v(()=>[n(Jt,{modelValue:s.value,"onUpdate:modelValue":b[5]||(b[5]=h=>s.value=h),"slider-color":"secondary","bg-color":"primary",dark:""},{default:v(()=>[n(Pe,{value:"go-terms"},{default:v(()=>[T(" GO terms ")]),_:1}),n(Pe,{value:"ec-numbers"},{default:v(()=>[T(" EC numbers ")]),_:1}),n(Pe,{value:"interpro"},{default:v(()=>[T(" Interpro ")]),_:1}),n(Oe),n(yt,{ref:"sortMenu","close-on-content-click":"",location:"bottom"},{activator:v(({props:h})=>[n(H,U({variant:"text"},h,{class:"align-self-center mr-4","prepend-icon":"mdi-sort-descending","append-icon":"mdi-menu-down"}),{default:v(()=>[T(X(i.value?"Peptides %":"Peptides"),1)]),_:2},1040)]),default:v(()=>[n(Ee,{class:"grey-lighten-3"},{default:v(()=>[n(pe,{density:"compact",class:"menu-header"},{default:v(()=>[T(" Sort by number of peptides in related proteins "),n(H,{icon:"mdi-help-circle",variant:"text",size:"small",onClick:b[1]||(b[1]=h=>u.value=!0)})]),_:1}),n(pe,{title:"Peptides %",onClick:b[2]||(b[2]=h=>i.value=!0)}),n(pe,{title:"Peptides",onClick:b[3]||(b[3]=h=>i.value=!1)})]),_:1})]),_:1},512),n(wo,{modelValue:u.value,"onUpdate:modelValue":b[4]||(b[4]=h=>u.value=h)},null,8,["modelValue"])]),_:1},8,["modelValue"]),n(ua,{modelValue:s.value,"onUpdate:modelValue":b[6]||(b[6]=h=>s.value=h),class:"mb-5"},{default:v(()=>[n(Ve,{value:"go-terms"},{default:v(()=>{var h,E,_,k,w,M;return[n(S(xl),{"analysis-in-progress":!S(t).analysisCompleted(S(t).activeAssayStatus.assay.id)||!S(t).filterCompleted(S(t).activeAssayStatus.assay.id),"go-processor":(h=S(t).activeAssayStatus.filteredData)==null?void 0:h.goCountTableProcessor,"go-ontology":(E=S(t).activeAssayStatus)==null?void 0:E.goOntology,"ncbi-processor":(k=(_=S(t).activeAssayStatus)==null?void 0:_.data)==null?void 0:k.lcaCountTableProcessor,"ncbi-tree":(M=(w=S(t).activeAssayStatus)==null?void 0:w.data)==null?void 0:M.tree,"show-percentage":i.value,"download-item":V,filter:S(t).activeAssayStatus.filterPercentage||5,onFilterPercentageChange:g},null,8,["analysis-in-progress","go-processor","go-ontology","ncbi-processor","ncbi-tree","show-percentage","filter"])]}),_:1}),n(Ve,{value:"ec-numbers"},{default:v(()=>{var h,E,_,k,w,M;return[n(S(kl),{"analysis-in-progress":!S(t).analysisCompleted(S(t).activeAssayStatus.assay.id)||!S(t).filterCompleted(S(t).activeAssayStatus.assay.id),"ec-processor":(h=S(t).activeAssayStatus.filteredData)==null?void 0:h.ecCountTableProcessor,"ec-ontology":(E=S(t).activeAssayStatus)==null?void 0:E.ecOntology,"ec-tree":c(),"ncbi-processor":(k=(_=S(t).activeAssayStatus)==null?void 0:_.data)==null?void 0:k.lcaCountTableProcessor,"ncbi-tree":(M=(w=S(t).activeAssayStatus)==null?void 0:w.data)==null?void 0:M.tree,"show-percentage":i.value,"download-item":y,filter:S(t).activeAssayStatus.filterPercentage||5,onFilterPercentageChange:g},null,8,["analysis-in-progress","ec-processor","ec-ontology","ec-tree","ncbi-processor","ncbi-tree","show-percentage","filter"])]}),_:1}),n(Ve,{value:"interpro"},{default:v(()=>{var h,E,_,k,w,M;return[n(S(Cl),{"analysis-in-progress":!S(t).analysisCompleted(S(t).activeAssayStatus.assay.id)||!S(t).filterCompleted(S(t).activeAssayStatus.assay.id),"interpro-processor":(h=S(t).activeAssayStatus.filteredData)==null?void 0:h.interproCountTableProcessor,"interpro-ontology":(E=S(t).activeAssayStatus)==null?void 0:E.interproOntology,"ncbi-processor":(k=(_=S(t).activeAssayStatus)==null?void 0:_.data)==null?void 0:k.lcaCountTableProcessor,"ncbi-tree":(M=(w=S(t).activeAssayStatus)==null?void 0:w.data)==null?void 0:M.tree,"show-percentage":i.value,"download-item":$,filter:S(t).activeAssayStatus.filterPercentage||5,onFilterPercentageChange:g},null,8,["analysis-in-progress","interpro-processor","interpro-ontology","ncbi-processor","ncbi-tree","show-percentage","filter"])]}),_:1})]),_:1},8,["modelValue"])]),_:1})]),_:1})]),_:1})],64)):(R(),j(be,{key:1,class:"search-info"},{default:v(()=>[n(me,{class:"info-step"},{default:v(()=>[Co,Ao]),_:1}),n(me,{class:"info-step"},{default:v(()=>[To,Io]),_:1}),n(me,{class:"info-step"},{default:v(()=>[Do,$o]),_:1})]),_:1}))]))}});const Zo=Ze(Oo,[["__scopeId","data-v-f4fdcfb1"]]);export{Zo as default};
